<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"><meta name="generator" content="Hugo 0.79.1" />
<link rel="apple-touch-icon" sizes="180x180" href='/favicons/apple-touch-icon.png'>
<link rel="icon" type="image/png" sizes="32x32" href='/favicons/favicon-32x32.png'>
<link rel="icon" type="image/png" sizes="16x16" href='/favicons/favicon-16x16.png'>
<link rel="manifest" href='/favicons/site.webmanifest'>
<link rel="mask-icon" href='/favicons/safari-pinned-tab.svg'  color="#004750">
<link rel="shortcut icon" href='/favicons/favicon.ico'>
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-config" content='/favicons/browserconfig.xml'>
<meta name="theme-color" content="#ffffff">

<title>Twitter Sentiment Philly | rjfranssen</title><meta property="og:title" content="Twitter Sentiment Philly" />
<meta property="og:description" content="1 2 3 4 5 6 7 8  # Knitr options: https://yihui.org/knitr/options/ library(lubridate) knitr::opts_chunk$set(collapse = TRUE , eval = TRUE , echo = TRUE , message = FALSE , warning = FALSE , include = TRUE)   % addTiles() %% setView(0,0,1) --Last updated 2020-12-30.
This is a walkthrough of using the Twitter API with the rtweet R package. It borrows from a few difference sources, including:
 ropensci/rtweet documentation here Tidy Text Mining with R Twitter Data in R Using Rtweet: Analyze and Download Twitter Data Comparing Twitter archives Mining NASA metadata Analyzing usenet text  Load libraries 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  #library(twitteR) library(rtweet) library(rmarkdown) library(NLP) library(tm) library(RColorBrewer) library(wordcloud) library(topicmodels) library(SnowballC) library(config) library(dplyr) library(tidytext) library(tidyr) library(ggplot2) library(lubridate) library(readr) library(skimr) library(widgetframe)   Configure Twitter API access There are a couple different ways to authenticate your session." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/2020/12/30/twitter-sentiment-philly/" />
<meta property="article:published_time" content="2020-12-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-12-30T00:00:00+00:00" />
<meta itemprop="name" content="Twitter Sentiment Philly">
<meta itemprop="description" content="1 2 3 4 5 6 7 8  # Knitr options: https://yihui.org/knitr/options/ library(lubridate) knitr::opts_chunk$set(collapse = TRUE , eval = TRUE , echo = TRUE , message = FALSE , warning = FALSE , include = TRUE)   % addTiles() %% setView(0,0,1) --Last updated 2020-12-30.
This is a walkthrough of using the Twitter API with the rtweet R package. It borrows from a few difference sources, including:
 ropensci/rtweet documentation here Tidy Text Mining with R Twitter Data in R Using Rtweet: Analyze and Download Twitter Data Comparing Twitter archives Mining NASA metadata Analyzing usenet text  Load libraries 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  #library(twitteR) library(rtweet) library(rmarkdown) library(NLP) library(tm) library(RColorBrewer) library(wordcloud) library(topicmodels) library(SnowballC) library(config) library(dplyr) library(tidytext) library(tidyr) library(ggplot2) library(lubridate) library(readr) library(skimr) library(widgetframe)   Configure Twitter API access There are a couple different ways to authenticate your session.">
<meta itemprop="datePublished" content="2020-12-30T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-12-30T00:00:00+00:00" />
<meta itemprop="wordCount" content="5245">



<meta itemprop="keywords" content="r,nlp,twitter," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Twitter Sentiment Philly"/>
<meta name="twitter:description" content="1 2 3 4 5 6 7 8  # Knitr options: https://yihui.org/knitr/options/ library(lubridate) knitr::opts_chunk$set(collapse = TRUE , eval = TRUE , echo = TRUE , message = FALSE , warning = FALSE , include = TRUE)   % addTiles() %% setView(0,0,1) --Last updated 2020-12-30.
This is a walkthrough of using the Twitter API with the rtweet R package. It borrows from a few difference sources, including:
 ropensci/rtweet documentation here Tidy Text Mining with R Twitter Data in R Using Rtweet: Analyze and Download Twitter Data Comparing Twitter archives Mining NASA metadata Analyzing usenet text  Load libraries 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  #library(twitteR) library(rtweet) library(rmarkdown) library(NLP) library(tm) library(RColorBrewer) library(wordcloud) library(topicmodels) library(SnowballC) library(config) library(dplyr) library(tidytext) library(tidyr) library(ggplot2) library(lubridate) library(readr) library(skimr) library(widgetframe)   Configure Twitter API access There are a couple different ways to authenticate your session."/>



<link rel="stylesheet" href="/css/styles.69832e4c6e36908110aac09480bc33c2fa3c11ac6d26d5ad4dce56911af6bd9c8d22888b83f35eaa93b258e9ab5fee9510c6b997fd63be1b42c0f74b8b61faf9.css" integrity="sha512-aYMuTG42kIEQqsCUgLwzwvo8EaxtJtWtTc5WkRr2vZyNIoiLg/NeqpOyWOmrX&#43;6VEMa5l/1jvhtCwPdLi2H6&#43;Q==" crossorigin="anonymous">

</head>
<body class="page-page">
  <header class="nav_header">
<nav class="wrap nav menu">
	<a href="/" class="nav_brand">
		<picture data-lit="/images/rjfranssen-blowfish-wide-dark.png" data-dark="/images/rjfranssen-blowfish-wide-dark.png">
			
			<img srcset = '/images/rjfranssen-blowfish-wide-dark.png' alt = 'rjfranssen Logo'>
		</picture>
		<label class="nav_toggle toggle" title="Site Menu" role="button">
			<svg class="icon">
  <use xlink:href="#harmburger"></use>
</svg>
		</label>
	</a>
	<ul class="nav_body">
		<li class="nav-item">
<div class="search">
  <label for="find" class="search_label"><svg class="icon">
  <use xlink:href="#search"></use>
</svg>
  </label>
  <input type="search" class="search_field" placeholder="Search..." id="find" autocomplete="off">
  <div class="search_results"></div>
</div>



		</li>
		<li class="nav-item">
			<a class="nav-link" href="/about/"><span>About</span></a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="/post/"><span>Posts</span></a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="/dash/"><span>Dashes</span></a>
		</li>
		<li class="nav-item">
			<a class="nav-link" href="/links/list/"><span>Links</span></a>
		</li>
		
		<li class="nav-item">
			<a class="nav-link" href="https://github.com/rjfranssen/rjfranssen.github.io" target="_blank">GitHub</a>
		</li>
		<li class="nav-item"><div class = 'color_mode'>
  <label for = 'mode'></label>
  <input type = 'checkbox' class = 'color_choice' id = 'mode' title="Toggle Dark Mode">
</div>
</li>
	</ul>
</nav>

  </header>
  <div class="main wrap pt-4"><div class="grid-auto"><aside class="aside menu">
  <div>
    <label class="aside_toggle toggle" title="Docs Menu" role="button">Docs Menu <svg class="icon">
  <use xlink:href="#harmburger"></use>
</svg></label>
  </div>
  <section class="section aside_inner">
    <h2 class="section_title"><a  href="/post/" class="group">Posts</a></h2>
      <section class="" id="docs-posts">
        <h3 class="section_link"><a id="docs-custom-color-palette" href="/2020/12/30/custom-color-palette/">Custom Color Palette</a></h3><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#acknowledgements">Acknowledgements</a></li>
        <li><a href="#references">References</a></li>
        <li><a href="#reproducibility">Reproducibility</a></li>
      </ul>
    </li>
  </ul>
</nav>
        <h3 class="section_link active"><a id="docs-twitter-sentiment-philly" href="/2020/12/30/twitter-sentiment-philly/">Twitter Sentiment Philly</a></h3><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#load-libraries">Load libraries</a></li>
        <li><a href="#configure-twitter-api-access">Configure Twitter API access</a></li>
        <li><a href="#query-the-tweets">Query the Tweets!</a></li>
        <li><a href="#examing-data">Examing data</a></li>
        <li><a href="#sample-stats--visualizations">Sample stats &amp; visualizations</a></li>
        <li><a href="#sentiment-analysis">Sentiment analysis</a></li>
        <li><a href="#comparing-sentiments">Comparing sentiments</a></li>
        <li><a href="#some-routine-checks">Some routine checks</a></li>
        <li><a href="#wordclouds">Wordclouds</a></li>
        <li><a href="#what-about-sentences">What about sentences?</a></li>
        <li><a href="#post-content">Post content</a></li>
        <li><a href="#r-image">R image</a></li>
        <li><a href="#custom-image">Custom image</a></li>
        <li><a href="#acknowledgements">Acknowledgements</a></li>
        <li><a href="#references">References</a></li>
        <li><a href="#reproducibility">Reproducibility</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </section>
  </section>
</aside>

  <main class="content">
    <h1>Twitter Sentiment Philly</h1><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Knitr options: https://yihui.org/knitr/options/</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span>
<span class="n">knitr</span><span class="o">::</span><span class="n">opts_chunk</span><span class="o">$</span><span class="nf">set</span><span class="p">(</span><span class="n">collapse</span> <span class="o">=</span> <span class="kc">TRUE</span>
                      <span class="p">,</span> <span class="n">eval</span> <span class="o">=</span> <span class="kc">TRUE</span>
                      <span class="p">,</span> <span class="n">echo</span> <span class="o">=</span> <span class="kc">TRUE</span>
                      <span class="p">,</span> <span class="n">message</span> <span class="o">=</span> <span class="kc">FALSE</span>
                      <span class="p">,</span> <span class="n">warning</span> <span class="o">=</span> <span class="kc">FALSE</span>
                      <span class="p">,</span> <span class="n">include</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- library(leaflet) -->
<!-- library(widgetframe) -->
<!-- l <- leaflet(height=300) %>% addTiles() %>% setView(0,0,1) -->
<!-- frameWidget(l) -->
<!-- ``` -->
<p>Last updated 2020-12-30.</p>
<p>This is a walkthrough of using the Twitter API with the <code>rtweet</code> R package. It borrows from a few difference sources, including:</p>
<ul>
<li><a href="https://github.com/ropensci/rtweet">ropensci/rtweet documentation</a></li>
<li><a href="https://gist.github.com/bryangoodrich/7b5ef683ce8db592669e">here</a></li>
<li><a href="https://www.tidytextmining.com/topicmodeling.html">Tidy Text Mining with R</a></li>
<li><a href="https://www.earthdatascience.org/courses/earth-analytics/get-data-using-apis/use-twitter-api-r/">Twitter Data in R Using Rtweet: Analyze and Download Twitter Data</a></li>
<li><a href="https://www.tidytextmining.com/twitter.html">Comparing Twitter archives</a></li>
<li><a href="https://www.tidytextmining.com/nasa.html">Mining NASA metadata</a></li>
<li><a href="https://www.tidytextmining.com/usenet.html">Analyzing usenet text</a></li>
</ul>
<h3 id="load-libraries">Load libraries</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1">#library(twitteR)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rtweet</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rmarkdown</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">NLP</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tm</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">topicmodels</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">SnowballC</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidytext</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">skimr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">widgetframe</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="configure-twitter-api-access">Configure Twitter API access</h3>
<p>There are a couple different ways to authenticate your session. The <code>rtweet</code> package makes this pretty easy by enabling browser-based authentication. I prefer to authenticate in code. See <code>vignette(&quot;auth&quot;, package = &quot;rtweet&quot;)</code> for options.</p>
<p>What I did: Head over to the <a href="https://developer.twitter.com/en/apply-for-access">Twitter Developer</a> site and requested a developer account to gain access to Twitter APIs and tools.</p>
<p>Then I used a <code>config.yml</code> to store my keys. The <code>config</code> package a good way to import keys and passwords without making them publc (just make sure they're covered by your <code>.gitignore</code> file!). Check out the <a href="https://cran.r-project.org/web/packages/config/vignettes/introduction.html">documentation</a>. <em>Note: If using Hugo and don't want it swept up into your <code>public</code> directory, you can also add <code>config.yml</code> to the <code>ignoreFiles</code> parameter in the <code>config.toml</code></em>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">config</span> <span class="o">&lt;-</span> <span class="n">config</span><span class="o">::</span><span class="nf">get</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;config.yml&#39;</span><span class="p">)</span>

<span class="c1">## authenticate via web browser</span>
<span class="n">token</span> <span class="o">&lt;-</span> <span class="nf">create_token</span><span class="p">(</span>
  <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="o">$</span><span class="n">app</span><span class="p">,</span>
  <span class="n">consumer_key</span> <span class="o">=</span> <span class="n">config</span><span class="o">$</span><span class="n">apikey</span><span class="p">,</span>
  <span class="n">consumer_secret</span> <span class="o">=</span> <span class="n">config</span><span class="o">$</span><span class="n">apikeysecret</span><span class="p">,</span>
  <span class="n">access_token</span> <span class="o">=</span> <span class="n">config</span><span class="o">$</span><span class="n">accesstoken</span><span class="p">,</span>
  <span class="n">access_secret</span> <span class="o">=</span> <span class="n">config</span><span class="o">$</span><span class="n">accesstokensecret</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="query-the-tweets">Query the Tweets!</h3>
<p>Going to ask for the most recent 2000.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Search tweets using rtweet search function</span>
<span class="n">tweets_df</span> <span class="o">&lt;-</span> <span class="n">rtweet</span><span class="o">::</span><span class="nf">search_tweets</span><span class="p">(</span>
  <span class="n">q</span> <span class="o">=</span> <span class="s">&#39;philadelphia philly&#39;</span>
  <span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">2000</span>
  <span class="p">,</span> <span class="n">include_rts</span> <span class="o">=</span> <span class="kc">FALSE</span>
  <span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#39;recent&#39;</span>
  <span class="c1">#, geocode = &#34;37.78, -122.40, 1mi&#34;</span>
  <span class="c1">#, retryonratelimit = TRUE</span>
  <span class="c1">#, parse = FALSE</span>
  <span class="c1">#, lang = &#39;en&#39; </span>
  <span class="c1"># ... see Twitter&#39;s REST API for more search parameters</span>
<span class="p">)</span>

<span class="c1">## Create lat/lng variables using all available tweet and profile geo-location data</span>
<span class="n">tweets_df</span> <span class="o">&lt;-</span> <span class="n">rtweet</span><span class="o">::</span><span class="nf">lat_lng</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">)</span>

<span class="c1">## Also going to create some friendlier date variables;`created_at` is a `POSIXct` type that requires a bit of tender loving care. WIll still keep the `created_at` value, which works great with `dygraphs` and just fine with `ggplot2`, but I want to be able to group by date variables.</span>
<span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_datetime</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">created_at</span>
<span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_date</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">created_at</span> <span class="o">%&gt;%</span> <span class="nf">as.POSIXlt</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">as.Date</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">ymd</span><span class="p">()</span>
<span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_year</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">created_at</span> <span class="o">%&gt;%</span> <span class="nf">as.POSIXlt</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">as.Date</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">year</span><span class="p">()</span>
<span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_month</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">created_at</span> <span class="o">%&gt;%</span> <span class="nf">as.POSIXlt</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">as.Date</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">month</span><span class="p">()</span>
<span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_day</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">created_at</span> <span class="o">%&gt;%</span> <span class="nf">as.POSIXlt</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">as.Date</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">day</span><span class="p">()</span>


<span class="n">tweets_df</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Optionally, save this df to a local directory so you come back to this later without having to hit the Twitter API; <code>Rds</code> and <code>Rdata</code> files load super fast. You can also add these file types to your <code>.gitignore</code> and <code>config.toml</code> if you don't want to push them to your online git repo.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">saveRDS</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;tweets_df.Rds&#34;</span><span class="p">,</span> <span class="n">compress</span> <span class="o">=</span> <span class="s">&#39;xz&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Reading back in the <code>.Rds</code> file..</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_df</span> <span class="o">&lt;-</span> <span class="nf">readRDS</span><span class="p">(</span><span class="s">&#34;tweets_df.Rds&#34;</span><span class="p">)</span>

<span class="n">tweets_df</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">(</span><span class="m">5</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">paged_table</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["user_id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["status_id"],"name":[2],"type":["chr"],"align":["left"]},{"label":["created_at"],"name":[3],"type":["dttm"],"align":["right"]},{"label":["screen_name"],"name":[4],"type":["chr"],"align":["left"]},{"label":["text"],"name":[5],"type":["chr"],"align":["left"]},{"label":["source"],"name":[6],"type":["chr"],"align":["left"]},{"label":["display_text_width"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["reply_to_status_id"],"name":[8],"type":["chr"],"align":["left"]},{"label":["reply_to_user_id"],"name":[9],"type":["chr"],"align":["left"]},{"label":["reply_to_screen_name"],"name":[10],"type":["chr"],"align":["left"]},{"label":["is_quote"],"name":[11],"type":["lgl"],"align":["right"]},{"label":["is_retweet"],"name":[12],"type":["lgl"],"align":["right"]},{"label":["favorite_count"],"name":[13],"type":["int"],"align":["right"]},{"label":["retweet_count"],"name":[14],"type":["int"],"align":["right"]},{"label":["quote_count"],"name":[15],"type":["int"],"align":["right"]},{"label":["reply_count"],"name":[16],"type":["int"],"align":["right"]},{"label":["hashtags"],"name":[17],"type":["list"],"align":["right"]},{"label":["symbols"],"name":[18],"type":["list"],"align":["right"]},{"label":["urls_url"],"name":[19],"type":["list"],"align":["right"]},{"label":["urls_t.co"],"name":[20],"type":["list"],"align":["right"]},{"label":["urls_expanded_url"],"name":[21],"type":["list"],"align":["right"]},{"label":["media_url"],"name":[22],"type":["list"],"align":["right"]},{"label":["media_t.co"],"name":[23],"type":["list"],"align":["right"]},{"label":["media_expanded_url"],"name":[24],"type":["list"],"align":["right"]},{"label":["media_type"],"name":[25],"type":["list"],"align":["right"]},{"label":["ext_media_url"],"name":[26],"type":["list"],"align":["right"]},{"label":["ext_media_t.co"],"name":[27],"type":["list"],"align":["right"]},{"label":["ext_media_expanded_url"],"name":[28],"type":["list"],"align":["right"]},{"label":["ext_media_type"],"name":[29],"type":["chr"],"align":["left"]},{"label":["mentions_user_id"],"name":[30],"type":["list"],"align":["right"]},{"label":["mentions_screen_name"],"name":[31],"type":["list"],"align":["right"]},{"label":["lang"],"name":[32],"type":["chr"],"align":["left"]},{"label":["quoted_status_id"],"name":[33],"type":["chr"],"align":["left"]},{"label":["quoted_text"],"name":[34],"type":["chr"],"align":["left"]},{"label":["quoted_created_at"],"name":[35],"type":["dttm"],"align":["right"]},{"label":["quoted_source"],"name":[36],"type":["chr"],"align":["left"]},{"label":["quoted_favorite_count"],"name":[37],"type":["int"],"align":["right"]},{"label":["quoted_retweet_count"],"name":[38],"type":["int"],"align":["right"]},{"label":["quoted_user_id"],"name":[39],"type":["chr"],"align":["left"]},{"label":["quoted_screen_name"],"name":[40],"type":["chr"],"align":["left"]},{"label":["quoted_name"],"name":[41],"type":["chr"],"align":["left"]},{"label":["quoted_followers_count"],"name":[42],"type":["int"],"align":["right"]},{"label":["quoted_friends_count"],"name":[43],"type":["int"],"align":["right"]},{"label":["quoted_statuses_count"],"name":[44],"type":["int"],"align":["right"]},{"label":["quoted_location"],"name":[45],"type":["chr"],"align":["left"]},{"label":["quoted_description"],"name":[46],"type":["chr"],"align":["left"]},{"label":["quoted_verified"],"name":[47],"type":["lgl"],"align":["right"]},{"label":["retweet_status_id"],"name":[48],"type":["chr"],"align":["left"]},{"label":["retweet_text"],"name":[49],"type":["chr"],"align":["left"]},{"label":["retweet_created_at"],"name":[50],"type":["dttm"],"align":["right"]},{"label":["retweet_source"],"name":[51],"type":["chr"],"align":["left"]},{"label":["retweet_favorite_count"],"name":[52],"type":["int"],"align":["right"]},{"label":["retweet_retweet_count"],"name":[53],"type":["int"],"align":["right"]},{"label":["retweet_user_id"],"name":[54],"type":["chr"],"align":["left"]},{"label":["retweet_screen_name"],"name":[55],"type":["chr"],"align":["left"]},{"label":["retweet_name"],"name":[56],"type":["chr"],"align":["left"]},{"label":["retweet_followers_count"],"name":[57],"type":["int"],"align":["right"]},{"label":["retweet_friends_count"],"name":[58],"type":["int"],"align":["right"]},{"label":["retweet_statuses_count"],"name":[59],"type":["int"],"align":["right"]},{"label":["retweet_location"],"name":[60],"type":["chr"],"align":["left"]},{"label":["retweet_description"],"name":[61],"type":["chr"],"align":["left"]},{"label":["retweet_verified"],"name":[62],"type":["lgl"],"align":["right"]},{"label":["place_url"],"name":[63],"type":["chr"],"align":["left"]},{"label":["place_name"],"name":[64],"type":["chr"],"align":["left"]},{"label":["place_full_name"],"name":[65],"type":["chr"],"align":["left"]},{"label":["place_type"],"name":[66],"type":["chr"],"align":["left"]},{"label":["country"],"name":[67],"type":["chr"],"align":["left"]},{"label":["country_code"],"name":[68],"type":["chr"],"align":["left"]},{"label":["geo_coords"],"name":[69],"type":["list"],"align":["right"]},{"label":["coords_coords"],"name":[70],"type":["list"],"align":["right"]},{"label":["bbox_coords"],"name":[71],"type":["list"],"align":["right"]},{"label":["status_url"],"name":[72],"type":["chr"],"align":["left"]},{"label":["name"],"name":[73],"type":["chr"],"align":["left"]},{"label":["location"],"name":[74],"type":["chr"],"align":["left"]},{"label":["description"],"name":[75],"type":["chr"],"align":["left"]},{"label":["url"],"name":[76],"type":["chr"],"align":["left"]},{"label":["protected"],"name":[77],"type":["lgl"],"align":["right"]},{"label":["followers_count"],"name":[78],"type":["int"],"align":["right"]},{"label":["friends_count"],"name":[79],"type":["int"],"align":["right"]},{"label":["listed_count"],"name":[80],"type":["int"],"align":["right"]},{"label":["statuses_count"],"name":[81],"type":["int"],"align":["right"]},{"label":["favourites_count"],"name":[82],"type":["int"],"align":["right"]},{"label":["account_created_at"],"name":[83],"type":["dttm"],"align":["right"]},{"label":["verified"],"name":[84],"type":["lgl"],"align":["right"]},{"label":["profile_url"],"name":[85],"type":["chr"],"align":["left"]},{"label":["profile_expanded_url"],"name":[86],"type":["chr"],"align":["left"]},{"label":["account_lang"],"name":[87],"type":["lgl"],"align":["right"]},{"label":["profile_banner_url"],"name":[88],"type":["chr"],"align":["left"]},{"label":["profile_background_url"],"name":[89],"type":["chr"],"align":["left"]},{"label":["profile_image_url"],"name":[90],"type":["chr"],"align":["left"]},{"label":["lat"],"name":[91],"type":["dbl"],"align":["right"]},{"label":["lng"],"name":[92],"type":["dbl"],"align":["right"]},{"label":["tweet_datetime"],"name":[93],"type":["dttm"],"align":["right"]},{"label":["tweet_date"],"name":[94],"type":["date"],"align":["right"]},{"label":["tweet_year"],"name":[95],"type":["dbl"],"align":["right"]},{"label":["tweet_month"],"name":[96],"type":["dbl"],"align":["right"]},{"label":["tweet_day"],"name":[97],"type":["int"],"align":["right"]}],"data":[{"1":"14221917","2":"1343970067323695105","3":"2020-12-29 17:20:08","4":"PhillyInquirer","5":"Union to sell Mark McKenzie to Belgium’s KRC Genk https://t.co/4GD0RsRv8s","6":"SocialFlow","7":"73","8":"NA","9":"NA","10":"NA","11":"FALSE","12":"FALSE","13":"0","14":"0","15":"NA","16":"NA","17":"<chr [1]>","18":"<chr [1]>","19":"<chr [1]>","20":"<chr [1]>","21":"<chr [1]>","22":"<chr [1]>","23":"<chr [1]>","24":"<chr [1]>","25":"<chr [1]>","26":"<chr [1]>","27":"<chr [1]>","28":"<chr [1]>","29":"NA","30":"<chr [1]>","31":"<chr [1]>","32":"de","33":"NA","34":"NA","35":"<NA>","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"<NA>","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"<dbl [2]>","70":"<dbl [2]>","71":"<dbl [8]>","72":"https://twitter.com/PhillyInquirer/status/1343970067323695105","73":"The Philadelphia Inquirer","74":"Philadelphia, PA","75":"The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","76":"https://t.co/QeWyyrUeoF","77":"FALSE","78":"418589","79":"1591","80":"2966","81":"199157","82":"705","83":"2008-03-26 01:57:54","84":"TRUE","85":"https://t.co/QeWyyrUeoF","86":"http://www.inquirer.com","87":"NA","88":"https://pbs.twimg.com/profile_banners/14221917/1559300463","89":"http://abs.twimg.com/images/themes/theme14/bg.gif","90":"http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","91":"NA","92":"NA","93":"2020-12-29 17:20:08","94":"2020-12-29","95":"2020","96":"12","97":"29"},{"1":"14221917","2":"1342156765228576771","3":"2020-12-24 17:14:43","4":"PhillyInquirer","5":"It's only the first game ... right? https://t.co/mFsDogez06","6":"SocialFlow","7":"59","8":"NA","9":"NA","10":"NA","11":"FALSE","12":"FALSE","13":"5","14":"1","15":"NA","16":"NA","17":"<chr [1]>","18":"<chr [1]>","19":"<chr [1]>","20":"<chr [1]>","21":"<chr [1]>","22":"<chr [1]>","23":"<chr [1]>","24":"<chr [1]>","25":"<chr [1]>","26":"<chr [1]>","27":"<chr [1]>","28":"<chr [1]>","29":"NA","30":"<chr [1]>","31":"<chr [1]>","32":"en","33":"NA","34":"NA","35":"<NA>","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"<NA>","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"<dbl [2]>","70":"<dbl [2]>","71":"<dbl [8]>","72":"https://twitter.com/PhillyInquirer/status/1342156765228576771","73":"The Philadelphia Inquirer","74":"Philadelphia, PA","75":"The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","76":"https://t.co/QeWyyrUeoF","77":"FALSE","78":"418589","79":"1591","80":"2966","81":"199157","82":"705","83":"2008-03-26 01:57:54","84":"TRUE","85":"https://t.co/QeWyyrUeoF","86":"http://www.inquirer.com","87":"NA","88":"https://pbs.twimg.com/profile_banners/14221917/1559300463","89":"http://abs.twimg.com/images/themes/theme14/bg.gif","90":"http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","91":"NA","92":"NA","93":"2020-12-24 17:14:43","94":"2020-12-24","95":"2020","96":"12","97":"24"},{"1":"14221917","2":"1343259117633363968","3":"2020-12-27 18:15:04","4":"PhillyInquirer","5":"Today's point of emphasis for the #Eagles against the #Cowboys: third down. @pdomo lays out what the Birds need to do to get the win. https://t.co/UwR050XZc8","6":"SocialFlow","7":"157","8":"NA","9":"NA","10":"NA","11":"FALSE","12":"FALSE","13":"4","14":"2","15":"NA","16":"NA","17":"<chr [2]>","18":"<chr [1]>","19":"<chr [1]>","20":"<chr [1]>","21":"<chr [1]>","22":"<chr [1]>","23":"<chr [1]>","24":"<chr [1]>","25":"<chr [1]>","26":"<chr [1]>","27":"<chr [1]>","28":"<chr [1]>","29":"NA","30":"<chr [1]>","31":"<chr [1]>","32":"en","33":"NA","34":"NA","35":"<NA>","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"<NA>","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"<dbl [2]>","70":"<dbl [2]>","71":"<dbl [8]>","72":"https://twitter.com/PhillyInquirer/status/1343259117633363968","73":"The Philadelphia Inquirer","74":"Philadelphia, PA","75":"The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","76":"https://t.co/QeWyyrUeoF","77":"FALSE","78":"418589","79":"1591","80":"2966","81":"199157","82":"705","83":"2008-03-26 01:57:54","84":"TRUE","85":"https://t.co/QeWyyrUeoF","86":"http://www.inquirer.com","87":"NA","88":"https://pbs.twimg.com/profile_banners/14221917/1559300463","89":"http://abs.twimg.com/images/themes/theme14/bg.gif","90":"http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","91":"NA","92":"NA","93":"2020-12-27 18:15:04","94":"2020-12-27","95":"2020","96":"12","97":"27"},{"1":"14221917","2":"1341815666563833856","3":"2020-12-23 18:39:19","4":"PhillyInquirer","5":"COVID-19 won't stop South Philadelphians from standing outside in the cold for Christmas cannoli. Some traditions never die. https://t.co/95oXsigsko","6":"SocialFlow","7":"148","8":"NA","9":"NA","10":"NA","11":"FALSE","12":"FALSE","13":"21","14":"2","15":"NA","16":"NA","17":"<chr [1]>","18":"<chr [1]>","19":"<chr [1]>","20":"<chr [1]>","21":"<chr [1]>","22":"<chr [1]>","23":"<chr [1]>","24":"<chr [1]>","25":"<chr [1]>","26":"<chr [1]>","27":"<chr [1]>","28":"<chr [1]>","29":"NA","30":"<chr [1]>","31":"<chr [1]>","32":"en","33":"NA","34":"NA","35":"<NA>","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"<NA>","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"<dbl [2]>","70":"<dbl [2]>","71":"<dbl [8]>","72":"https://twitter.com/PhillyInquirer/status/1341815666563833856","73":"The Philadelphia Inquirer","74":"Philadelphia, PA","75":"The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","76":"https://t.co/QeWyyrUeoF","77":"FALSE","78":"418589","79":"1591","80":"2966","81":"199157","82":"705","83":"2008-03-26 01:57:54","84":"TRUE","85":"https://t.co/QeWyyrUeoF","86":"http://www.inquirer.com","87":"NA","88":"https://pbs.twimg.com/profile_banners/14221917/1559300463","89":"http://abs.twimg.com/images/themes/theme14/bg.gif","90":"http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","91":"NA","92":"NA","93":"2020-12-23 18:39:19","94":"2020-12-23","95":"2020","96":"12","97":"23"},{"1":"14221917","2":"1342189758647324675","3":"2020-12-24 19:25:49","4":"PhillyInquirer","5":"New art installation in jeopardy after mural of queer activist Gloria Casarez in Philly’s Gayborhood whitewashed without warning https://t.co/sAOX0BSTz0","6":"SocialFlow","7":"152","8":"NA","9":"NA","10":"NA","11":"FALSE","12":"FALSE","13":"4","14":"8","15":"NA","16":"NA","17":"<chr [1]>","18":"<chr [1]>","19":"<chr [1]>","20":"<chr [1]>","21":"<chr [1]>","22":"<chr [1]>","23":"<chr [1]>","24":"<chr [1]>","25":"<chr [1]>","26":"<chr [1]>","27":"<chr [1]>","28":"<chr [1]>","29":"NA","30":"<chr [1]>","31":"<chr [1]>","32":"en","33":"NA","34":"NA","35":"<NA>","36":"NA","37":"NA","38":"NA","39":"NA","40":"NA","41":"NA","42":"NA","43":"NA","44":"NA","45":"NA","46":"NA","47":"NA","48":"NA","49":"NA","50":"<NA>","51":"NA","52":"NA","53":"NA","54":"NA","55":"NA","56":"NA","57":"NA","58":"NA","59":"NA","60":"NA","61":"NA","62":"NA","63":"NA","64":"NA","65":"NA","66":"NA","67":"NA","68":"NA","69":"<dbl [2]>","70":"<dbl [2]>","71":"<dbl [8]>","72":"https://twitter.com/PhillyInquirer/status/1342189758647324675","73":"The Philadelphia Inquirer","74":"Philadelphia, PA","75":"The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","76":"https://t.co/QeWyyrUeoF","77":"FALSE","78":"418589","79":"1591","80":"2966","81":"199157","82":"705","83":"2008-03-26 01:57:54","84":"TRUE","85":"https://t.co/QeWyyrUeoF","86":"http://www.inquirer.com","87":"NA","88":"https://pbs.twimg.com/profile_banners/14221917/1559300463","89":"http://abs.twimg.com/images/themes/theme14/bg.gif","90":"http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","91":"NA","92":"NA","93":"2020-12-24 19:25:49","94":"2020-12-24","95":"2020","96":"12","97":"24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_df</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">(</span><span class="m">5</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">DT</span><span class="o">::</span><span class="nf">datatable</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><!--html_preserve--><div id="htmlwidget-954cef94d0beffd49a2e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-954cef94d0beffd49a2e">{"x":{"filter":"none","data":[["1","2","3","4","5"],["14221917","14221917","14221917","14221917","14221917"],["1343970067323695105","1342156765228576771","1343259117633363968","1341815666563833856","1342189758647324675"],["2020-12-29T17:20:08Z","2020-12-24T17:14:43Z","2020-12-27T18:15:04Z","2020-12-23T18:39:19Z","2020-12-24T19:25:49Z"],["PhillyInquirer","PhillyInquirer","PhillyInquirer","PhillyInquirer","PhillyInquirer"],["Union to sell Mark McKenzie to Belgium’s KRC Genk https://t.co/4GD0RsRv8s","It's only the first game ... right? https://t.co/mFsDogez06","Today's point of emphasis for the #Eagles against the #Cowboys: third down. @pdomo lays out what the Birds need to do to get the win. https://t.co/UwR050XZc8","COVID-19 won't stop South Philadelphians from standing outside in the cold for Christmas cannoli. Some traditions never die. https://t.co/95oXsigsko","New art installation in jeopardy after mural of queer activist Gloria Casarez in Philly’s Gayborhood whitewashed without warning https://t.co/sAOX0BSTz0"],["SocialFlow","SocialFlow","SocialFlow","SocialFlow","SocialFlow"],[73,59,157,148,152],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[false,false,false,false,false],[false,false,false,false,false],[0,5,4,21,4],[0,1,2,2,8],[null,null,null,null,null],[null,null,null,null,null],[null,null,["Eagles","Cowboys"],null,null],[null,null,null,null,null],["trib.al/wpKTAzt","trib.al/fAjShdh","trib.al/Ukuhrda","trib.al/c1It62G","trib.al/MRKrVR2"],["https://t.co/4GD0RsRv8s","https://t.co/mFsDogez06","https://t.co/UwR050XZc8","https://t.co/95oXsigsko","https://t.co/sAOX0BSTz0"],["https://trib.al/wpKTAzt","https://trib.al/fAjShdh","https://trib.al/Ukuhrda","https://trib.al/c1It62G","https://trib.al/MRKrVR2"],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,"168750735",null,null],[null,null,"pdomo",null,null],["de","en","en","en","en"],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[null,null,null,null,null],[[null,null],[null,null],[null,null],[null,null],[null,null]],[[null,null],[null,null],[null,null],[null,null],[null,null]],[[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null]],["https://twitter.com/PhillyInquirer/status/1343970067323695105","https://twitter.com/PhillyInquirer/status/1342156765228576771","https://twitter.com/PhillyInquirer/status/1343259117633363968","https://twitter.com/PhillyInquirer/status/1341815666563833856","https://twitter.com/PhillyInquirer/status/1342189758647324675"],["The Philadelphia Inquirer","The Philadelphia Inquirer","The Philadelphia Inquirer","The Philadelphia Inquirer","The Philadelphia Inquirer"],["Philadelphia, PA","Philadelphia, PA","Philadelphia, PA","Philadelphia, PA","Philadelphia, PA"],["The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs.","The Philadelphia Inquirer is your front-row seat to the Greater Philadelphia region. You can support local, impactful journalism at https://t.co/Dw4BC5NdNs."],["https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF"],[false,false,false,false,false],[418589,418589,418589,418589,418589],[1591,1591,1591,1591,1591],[2966,2966,2966,2966,2966],[199157,199157,199157,199157,199157],[705,705,705,705,705],["2008-03-26T01:57:54Z","2008-03-26T01:57:54Z","2008-03-26T01:57:54Z","2008-03-26T01:57:54Z","2008-03-26T01:57:54Z"],[true,true,true,true,true],["https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF","https://t.co/QeWyyrUeoF"],["http://www.inquirer.com","http://www.inquirer.com","http://www.inquirer.com","http://www.inquirer.com","http://www.inquirer.com"],[null,null,null,null,null],["https://pbs.twimg.com/profile_banners/14221917/1559300463","https://pbs.twimg.com/profile_banners/14221917/1559300463","https://pbs.twimg.com/profile_banners/14221917/1559300463","https://pbs.twimg.com/profile_banners/14221917/1559300463","https://pbs.twimg.com/profile_banners/14221917/1559300463"],["http://abs.twimg.com/images/themes/theme14/bg.gif","http://abs.twimg.com/images/themes/theme14/bg.gif","http://abs.twimg.com/images/themes/theme14/bg.gif","http://abs.twimg.com/images/themes/theme14/bg.gif","http://abs.twimg.com/images/themes/theme14/bg.gif"],["http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png","http://pbs.twimg.com/profile_images/1134416080645083138/U3Kox7Ld_normal.png"],[null,null,null,null,null],[null,null,null,null,null],["2020-12-29T17:20:08Z","2020-12-24T17:14:43Z","2020-12-27T18:15:04Z","2020-12-23T18:39:19Z","2020-12-24T19:25:49Z"],["2020-12-29","2020-12-24","2020-12-27","2020-12-23","2020-12-24"],[2020,2020,2020,2020,2020],[12,12,12,12,12],[29,24,27,23,24]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>user_id<\/th>\n      <th>status_id<\/th>\n      <th>created_at<\/th>\n      <th>screen_name<\/th>\n      <th>text<\/th>\n      <th>source<\/th>\n      <th>display_text_width<\/th>\n      <th>reply_to_status_id<\/th>\n      <th>reply_to_user_id<\/th>\n      <th>reply_to_screen_name<\/th>\n      <th>is_quote<\/th>\n      <th>is_retweet<\/th>\n      <th>favorite_count<\/th>\n      <th>retweet_count<\/th>\n      <th>quote_count<\/th>\n      <th>reply_count<\/th>\n      <th>hashtags<\/th>\n      <th>symbols<\/th>\n      <th>urls_url<\/th>\n      <th>urls_t.co<\/th>\n      <th>urls_expanded_url<\/th>\n      <th>media_url<\/th>\n      <th>media_t.co<\/th>\n      <th>media_expanded_url<\/th>\n      <th>media_type<\/th>\n      <th>ext_media_url<\/th>\n      <th>ext_media_t.co<\/th>\n      <th>ext_media_expanded_url<\/th>\n      <th>ext_media_type<\/th>\n      <th>mentions_user_id<\/th>\n      <th>mentions_screen_name<\/th>\n      <th>lang<\/th>\n      <th>quoted_status_id<\/th>\n      <th>quoted_text<\/th>\n      <th>quoted_created_at<\/th>\n      <th>quoted_source<\/th>\n      <th>quoted_favorite_count<\/th>\n      <th>quoted_retweet_count<\/th>\n      <th>quoted_user_id<\/th>\n      <th>quoted_screen_name<\/th>\n      <th>quoted_name<\/th>\n      <th>quoted_followers_count<\/th>\n      <th>quoted_friends_count<\/th>\n      <th>quoted_statuses_count<\/th>\n      <th>quoted_location<\/th>\n      <th>quoted_description<\/th>\n      <th>quoted_verified<\/th>\n      <th>retweet_status_id<\/th>\n      <th>retweet_text<\/th>\n      <th>retweet_created_at<\/th>\n      <th>retweet_source<\/th>\n      <th>retweet_favorite_count<\/th>\n      <th>retweet_retweet_count<\/th>\n      <th>retweet_user_id<\/th>\n      <th>retweet_screen_name<\/th>\n      <th>retweet_name<\/th>\n      <th>retweet_followers_count<\/th>\n      <th>retweet_friends_count<\/th>\n      <th>retweet_statuses_count<\/th>\n      <th>retweet_location<\/th>\n      <th>retweet_description<\/th>\n      <th>retweet_verified<\/th>\n      <th>place_url<\/th>\n      <th>place_name<\/th>\n      <th>place_full_name<\/th>\n      <th>place_type<\/th>\n      <th>country<\/th>\n      <th>country_code<\/th>\n      <th>geo_coords<\/th>\n      <th>coords_coords<\/th>\n      <th>bbox_coords<\/th>\n      <th>status_url<\/th>\n      <th>name<\/th>\n      <th>location<\/th>\n      <th>description<\/th>\n      <th>url<\/th>\n      <th>protected<\/th>\n      <th>followers_count<\/th>\n      <th>friends_count<\/th>\n      <th>listed_count<\/th>\n      <th>statuses_count<\/th>\n      <th>favourites_count<\/th>\n      <th>account_created_at<\/th>\n      <th>verified<\/th>\n      <th>profile_url<\/th>\n      <th>profile_expanded_url<\/th>\n      <th>account_lang<\/th>\n      <th>profile_banner_url<\/th>\n      <th>profile_background_url<\/th>\n      <th>profile_image_url<\/th>\n      <th>lat<\/th>\n      <th>lng<\/th>\n      <th>tweet_datetime<\/th>\n      <th>tweet_date<\/th>\n      <th>tweet_year<\/th>\n      <th>tweet_month<\/th>\n      <th>tweet_day<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[7,13,14,15,16,37,38,42,43,44,52,53,57,58,59,78,79,80,81,82,91,92,95,96,97]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<h3 id="examing-data">Examing data</h3>
<p>Now going to identify a few basic things, but first, this df has 92 columns. What are some of the columns that we're most likely to use? The <code>skimr</code> package is <strong>really</strong> good at doing this and is a good substitute for <code>summary()</code> in many cases.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_df</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span>
  <span class="c1"># About the tweet</span>
  <span class="n">text</span>
  <span class="p">,</span> <span class="n">lang</span>
  <span class="p">,</span> <span class="n">hashtags</span>
  <span class="p">,</span> <span class="n">symbols</span>
  <span class="p">,</span> <span class="n">favorite_count</span>
  <span class="p">,</span> <span class="n">retweet_count</span>
  <span class="p">,</span> <span class="n">lat</span>
  <span class="p">,</span> <span class="n">lng</span>
  <span class="c1"># About the user</span>
  <span class="p">,</span> <span class="n">name</span>
  <span class="p">,</span> <span class="n">screen_name</span>
  <span class="p">,</span> <span class="n">followers_count</span>
  <span class="p">,</span> <span class="n">friends_count</span>
  <span class="p">,</span> <span class="n">location</span>
  <span class="p">,</span> <span class="n">description</span>
  <span class="p">,</span> <span class="n">listed_count</span>
  <span class="p">,</span> <span class="n">statuses_count</span>
  <span class="p">,</span> <span class="n">created_at</span>
  <span class="p">,</span> <span class="n">account_created_at</span>
  <span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 18</span>
<span class="c1">##   text  lang  hashtags symbols favorite_count retweet_count   lat   lng name </span>
<span class="c1">##   &lt;chr&gt; &lt;chr&gt; &lt;list&gt;   &lt;list&gt;           &lt;int&gt;         &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span>
<span class="c1">## 1 &#34;Uni~ de    &lt;chr [1~ &lt;chr [~              0             0    NA    NA The ~</span>
<span class="c1">## 2 &#34;It&#39;~ en    &lt;chr [1~ &lt;chr [~              5             1    NA    NA The ~</span>
<span class="c1">## 3 &#34;Tod~ en    &lt;chr [2~ &lt;chr [~              4             2    NA    NA The ~</span>
<span class="c1">## 4 &#34;COV~ en    &lt;chr [1~ &lt;chr [~             21             2    NA    NA The ~</span>
<span class="c1">## 5 &#34;New~ en    &lt;chr [1~ &lt;chr [~              4             8    NA    NA The ~</span>
<span class="c1">## 6 &#34;&lt;U+274C&gt; S~ en    &lt;chr [1~ &lt;chr [~              5             2    NA    NA The ~</span>
<span class="c1">## # ... with 9 more variables: screen_name &lt;chr&gt;, followers_count &lt;int&gt;,</span>
<span class="c1">## #   friends_count &lt;int&gt;, location &lt;chr&gt;, description &lt;chr&gt;, listed_count &lt;int&gt;,</span>
<span class="c1">## #   statuses_count &lt;int&gt;, created_at &lt;dttm&gt;, account_created_at &lt;dttm&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="sample-stats--visualizations">Sample stats &amp; visualizations</h3>
<p>What is our total tweet <em>count</em>?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">nrow</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">)</span>
<span class="c1">## [1] 1897</span>
</code></pre></td></tr></table>
</div>
</div><p>What is the most <em>favorited</em> tweet?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_df</span> <span class="o">%&gt;%</span>
  <span class="nf">slice_max</span><span class="p">(</span><span class="n">favorite_count</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># can also use arrange()</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">screen_name</span>
         <span class="p">,</span> <span class="n">text</span>
         <span class="p">,</span> <span class="n">favorite_count</span>
         <span class="p">,</span> <span class="n">created_at</span><span class="p">)</span>
<span class="c1">## # A tibble: 1 x 4</span>
<span class="c1">##   screen_name text                            favorite_count created_at         </span>
<span class="c1">##   &lt;chr&gt;       &lt;chr&gt;                                    &lt;int&gt; &lt;dttm&gt;             </span>
<span class="c1">## 1 GetUpESPN   &#34;\&#34;Carson Wentz is soft! ... H~           1993 2020-12-21 16:16:24</span>
</code></pre></td></tr></table>
</div>
</div><p>What users are <em>tweeting the most</em>?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">top_tweeters</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">screen_name</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">num_tweets</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
  <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">num_tweets</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># can also use slice_max()</span>
  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">(</span><span class="m">5</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">top_tweeters</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">screen_name</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">num_tweets</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">screen_name</span><span class="p">),</span> <span class="n">stat</span> <span class="o">=</span> <span class="s">&#39;identity&#39;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">scale_fill_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;What users are tweeting the most?&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Number of Tweets&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/statsthree-1.png" width="672" /></p>
<p>In what <em>languages</em> are they tweeting?</p>
<p>Languages are recorded here as <a href="https://www.loc.gov/standards/iso639-2/php/code_list.php">alpha-3 / ISO 639.2 codes</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_df</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">lang</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">num_tweets</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
  <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">num_tweets</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># can also use slice_max()</span>
  <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
<span class="c1">## # A tibble: 10 x 2</span>
<span class="c1">##    lang  num_tweets</span>
<span class="c1">##    &lt;chr&gt;      &lt;int&gt;</span>
<span class="c1">##  1 en          1829</span>
<span class="c1">##  2 und           34</span>
<span class="c1">##  3 cy             8</span>
<span class="c1">##  4 es             6</span>
<span class="c1">##  5 de             3</span>
<span class="c1">##  6 et             3</span>
<span class="c1">##  7 ja             3</span>
<span class="c1">##  8 fr             2</span>
<span class="c1">##  9 pt             2</span>
<span class="c1">## 10 ro             2</span>

<span class="c1"># ggplot(tweets_df) +</span>
<span class="c1">#   geom_bar(aes(x = lang, fill = lang))</span>
</code></pre></td></tr></table>
</div>
</div><p>What <em>platforms</em> are people using?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">users_by_source</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">num_users</span> <span class="o">=</span> <span class="nf">n_distinct</span><span class="p">(</span><span class="n">user_id</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">num_users</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># can also use slice_max()</span>
  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">users_by_source</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">num_users</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">num_users</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">source</span><span class="p">),</span> <span class="n">stat</span> <span class="o">=</span> <span class="s">&#39;identity&#39;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">coord_flip</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">theme_gray</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="c1">#theme(legend.title = element_blank()) +</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Top 10 Twitter Platforms People are Using&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Number of Users&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">400</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="m">50</span><span class="p">),</span> <span class="n">limits</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">400</span><span class="p">),</span> <span class="n">expand</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> <span class="o">+</span> <span class="c1"># use expand() to remove empty space between axis and bars</span>
  <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">400</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="m">25</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#39;white&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/statsfive-1.png" width="672" /></p>
<p><em>How many</em> tweets per day?</p>
<p>Going to create a chart with <a href="https://plotly-r.com/improving-ggplotly.html">ggplot2 and plotly</a> and a second one with <a href="https://rstudio.github.io/dygraphs/index.html">dygraphs for r</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_per_day</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">tweet_date</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">num_tweets</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
  <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">num_tweets</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># can also use slice_max()</span>
  <span class="nf">ungroup</span><span class="p">()</span>

<span class="c1"># Using ggplot + plotly</span>
<span class="nf">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="n">plt1</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">tweets_per_day</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">tweet_date</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">num_tweets</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">scale_fill_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme_gray</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Daily Tweets&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Number of Tweets&#34;</span><span class="p">)</span> 

<span class="n">plotly</span><span class="o">::</span><span class="nf">ggplotly</span><span class="p">(</span><span class="n">plt1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><!--html_preserve--><div id="htmlwidget-755369a1bc8ac2e6b05b" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-755369a1bc8ac2e6b05b">{"x":{"data":[{"x":[18617,18618,18619,18620,18621,18622,18623,18624,18625],"y":[194,287,290,240,159,138,203,240,146],"text":["tweet_date: 2020-12-21<br />num_tweets: 194","tweet_date: 2020-12-22<br />num_tweets: 287","tweet_date: 2020-12-23<br />num_tweets: 290","tweet_date: 2020-12-24<br />num_tweets: 240","tweet_date: 2020-12-25<br />num_tweets: 159","tweet_date: 2020-12-26<br />num_tweets: 138","tweet_date: 2020-12-27<br />num_tweets: 203","tweet_date: 2020-12-28<br />num_tweets: 240","tweet_date: 2020-12-29<br />num_tweets: 146"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Daily Tweets","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18616.6,18625.4],"tickmode":"array","ticktext":["Dec 22","Dec 24","Dec 26","Dec 28"],"tickvals":[18618,18620,18622,18624],"categoryorder":"array","categoryarray":["Dec 22","Dec 24","Dec 26","Dec 28"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[130.4,297.6],"tickmode":"array","ticktext":["150","200","250"],"tickvals":[150,200,250],"categoryorder":"array","categoryarray":["150","200","250"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Number of Tweets","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"28346fdd5239":{"x":{},"y":{},"type":"scatter"}},"cur_data":"28346fdd5239","visdat":{"28346fdd5239":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Using dygraph</span>
<span class="c1"># convert series to an xts object </span>
<span class="n">tweets_ts</span> <span class="o">&lt;-</span> <span class="n">xts</span><span class="o">::</span><span class="nf">xts</span><span class="p">(</span><span class="n">tweets_per_day</span><span class="o">$</span><span class="n">num_tweets</span><span class="p">,</span> <span class="n">order.by</span> <span class="o">=</span> <span class="n">tweets_per_day</span><span class="o">$</span><span class="n">tweet_date</span><span class="p">)</span>
<span class="c1"># Create the dygraph</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dygraphs</span><span class="p">)</span>
<span class="nf">dygraph</span><span class="p">(</span><span class="n">tweets_ts</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Daily Tweets for &#39;Philadelphia&#39;&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">dySeries</span><span class="p">(</span><span class="s">&#34;V1&#34;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s">&#34;Tweet Count&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>And <em>where</em> are people tweeting?</p>
<p>Of the 1897 tweets that we have, 133 are geotagged. We'll plot those using <a href="https://rstudio.github.io/leaflet/">leaflet</a> and build on this later.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">leaflet</span><span class="p">)</span>

<span class="n">tweet_map</span> <span class="o">&lt;-</span> <span class="nf">leaflet</span><span class="p">(</span><span class="n">tweets_df</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">addTiles</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">addCircleMarkers</span><span class="p">(</span><span class="n">lng</span> <span class="o">=</span> <span class="o">~</span><span class="n">lng</span>
                   <span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="o">~</span><span class="n">lat</span><span class="p">)</span>

<span class="n">htmlwidgets</span><span class="o">::</span><span class="nf">saveWidget</span><span class="p">(</span><span class="n">widget</span> <span class="o">=</span> <span class="n">tweet_map</span>
                        <span class="p">,</span> <span class="s">&#39;tweet_map.html&#39;</span>
                        <span class="p">,</span> <span class="n">selfcontained</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><!-- ```{r mapshow} -->
<!-- knitr::include_url(url = 'tweet_map.html', height = "400px") -->
<!-- ``` -->
<iframe src="tweet_map.html" width="600" height="400" style="border: none;"></iframe>
<h3 id="sentiment-analysis">Sentiment analysis</h3>
<p>Now switching over to <a href="https://www.tidytextmining.com/topicmodeling.html">tidytext</a></p>
<blockquote>
<p>The function <code>get_sentiments()</code> allows us to get specific sentiment lexicons with the appropriate measures for each one.</p>
</blockquote>
<p>Preview some of the sentiment lexicons. You'll be prompted to download the <code>textdata</code> package and the <code>afinn</code>, <code>bing</code>, and <code>nrc</code> lexicons if you don't have them already.</p>
<p><strong><a href="http://www2.imm.dtu.dk/pubdb/pubs/6010-full.html">afinn</a></strong> - assigns a numeric value to each word on a scale of -5 to +5
<strong><a href="https://www.cs.uic.edu/~liub/FBS/sentiment-analysis.html">bing</a></strong> - binary assignment to each word, e.g. 'positive' or 'negative'<br>
<strong><a href="http://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm">nrc</a></strong> - categorizes words into categories: positive, negative, anger, anticipation, disgust, fear, joy, sadness, surprise, and trust</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1">#install.packages(&#34;textdata&#34;)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidytext</span><span class="p">)</span>

<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;afinn&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 2</span>
<span class="c1">##   word       value</span>
<span class="c1">##   &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="c1">## 1 abandon       -2</span>
<span class="c1">## 2 abandoned     -2</span>
<span class="c1">## 3 abandons      -2</span>
<span class="c1">## 4 abducted      -2</span>
<span class="c1">## 5 abduction     -2</span>
<span class="c1">## 6 abductions    -2</span>
<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 2</span>
<span class="c1">##   word       sentiment</span>
<span class="c1">##   &lt;chr&gt;      &lt;chr&gt;    </span>
<span class="c1">## 1 2-faces    negative </span>
<span class="c1">## 2 abnormal   negative </span>
<span class="c1">## 3 abolish    negative </span>
<span class="c1">## 4 abominable negative </span>
<span class="c1">## 5 abominably negative </span>
<span class="c1">## 6 abominate  negative</span>
<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;nrc&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 2</span>
<span class="c1">##   word      sentiment</span>
<span class="c1">##   &lt;chr&gt;     &lt;chr&gt;    </span>
<span class="c1">## 1 abacus    trust    </span>
<span class="c1">## 2 abandon   fear     </span>
<span class="c1">## 3 abandon   negative </span>
<span class="c1">## 4 abandon   sadness  </span>
<span class="c1">## 5 abandoned anger    </span>
<span class="c1">## 6 abandoned fear</span>
</code></pre></td></tr></table>
</div>
</div><p>Now tidy up the data and prepare it for analysis. If running this with the <code>austen_books()</code> example from the <a href="https://www.tidytextmining.com/sentiment.html">tidytext docs</a>, it's relatively straightforward:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">janeaustenr</span><span class="p">)</span>

<span class="n">tidy_books</span> <span class="o">&lt;-</span> <span class="nf">austen_books</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">book</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span>
    <span class="n">linenumber</span> <span class="o">=</span> <span class="nf">row_number</span><span class="p">(),</span>
    <span class="n">chapter</span> <span class="o">=</span> <span class="nf">cumsum</span><span class="p">(</span><span class="nf">str_detect</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> 
                                <span class="nf">regex</span><span class="p">(</span><span class="s">&#34;^chapter [\\divxlc]&#34;</span><span class="p">,</span> 
                                      <span class="n">ignore_case</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">))))</span> <span class="o">%&gt;%</span>
  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<span class="n">tidy_books</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 4</span>
<span class="c1">##   book                linenumber chapter word       </span>
<span class="c1">##   &lt;fct&gt;                    &lt;int&gt;   &lt;int&gt; &lt;chr&gt;      </span>
<span class="c1">## 1 Sense &amp; Sensibility          1       0 sense      </span>
<span class="c1">## 2 Sense &amp; Sensibility          1       0 and        </span>
<span class="c1">## 3 Sense &amp; Sensibility          1       0 sensibility</span>
<span class="c1">## 4 Sense &amp; Sensibility          3       0 by         </span>
<span class="c1">## 5 Sense &amp; Sensibility          3       0 jane       </span>
<span class="c1">## 6 Sense &amp; Sensibility          3       0 austen</span>
</code></pre></td></tr></table>
</div>
</div><p>But I want to run this on tweets, so I need to reshape the data. I only executed one search for <code>philadelphia+philly</code>, so I'm going to build a dataframe from that. Though, we can run multiple searches and assign each search its own <code>book</code> value to enable comparisons and faceted plots later.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tweets_book</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="s">&#39;Philadelphia&#39;</span><span class="p">,</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">text</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">data.frame</span><span class="p">()</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">tweets_book</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;book&#39;</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">)</span>

<span class="c1"># Reformat the date - running above insists on converting the `tweet_date` value to its integer form.</span>
<span class="n">tweets_book</span><span class="o">$</span><span class="n">chapter</span> <span class="o">&lt;-</span> <span class="n">tweets_df</span><span class="o">$</span><span class="n">tweet_date</span>

<span class="n">tidy_books</span> <span class="o">&lt;-</span> <span class="n">tweets_book</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">book</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span>
    <span class="n">linenumber</span> <span class="o">=</span> <span class="nf">row_number</span><span class="p">()</span>
    <span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<span class="n">tidy_books</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 4</span>
<span class="c1">##   book         chapter    linenumber word    </span>
<span class="c1">##   &lt;chr&gt;        &lt;date&gt;          &lt;int&gt; &lt;chr&gt;   </span>
<span class="c1">## 1 Philadelphia 2020-12-29          1 union   </span>
<span class="c1">## 2 Philadelphia 2020-12-29          1 to      </span>
<span class="c1">## 3 Philadelphia 2020-12-29          1 sell    </span>
<span class="c1">## 4 Philadelphia 2020-12-29          1 mark    </span>
<span class="c1">## 5 Philadelphia 2020-12-29          1 mckenzie</span>
<span class="c1">## 6 Philadelphia 2020-12-29          1 to</span>
</code></pre></td></tr></table>
</div>
</div><p>Now the tweets are in a tidy format with one word per row.</p>
<p>Looking at the <code>nrc</code> lexicon, what are some of the &quot;joy&quot; words?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">nrc_joy</span> <span class="o">&lt;-</span> <span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;nrc&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">==</span> <span class="s">&#34;joy&#34;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">nrc_joy</span><span class="p">)</span>
<span class="c1">## # A tibble: 6 x 2</span>
<span class="c1">##   word          sentiment</span>
<span class="c1">##   &lt;chr&gt;         &lt;chr&gt;    </span>
<span class="c1">## 1 absolution    joy      </span>
<span class="c1">## 2 abundance     joy      </span>
<span class="c1">## 3 abundant      joy      </span>
<span class="c1">## 4 accolade      joy      </span>
<span class="c1">## 5 accompaniment joy      </span>
<span class="c1">## 6 accomplish    joy</span>
</code></pre></td></tr></table>
</div>
</div><p>How many &quot;joy&quot; words do we have in our tweets?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="n">book</span> <span class="o">==</span> <span class="s">&#34;Philadelphia&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">inner_join</span><span class="p">(</span><span class="n">nrc_joy</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">head</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
<span class="c1">## # A tibble: 10 x 2</span>
<span class="c1">##    word        n</span>
<span class="c1">##    &lt;chr&gt;   &lt;int&gt;</span>
<span class="c1">##  1 love       58</span>
<span class="c1">##  2 good       56</span>
<span class="c1">##  3 holiday    52</span>
<span class="c1">##  4 art        36</span>
<span class="c1">##  5 food       29</span>
<span class="c1">##  6 music      27</span>
<span class="c1">##  7 deal       24</span>
<span class="c1">##  8 save       24</span>
<span class="c1">##  9 safe       23</span>
<span class="c1">## 10 happy      21</span>
</code></pre></td></tr></table>
</div>
</div><p>Using <code>tidyr</code>, we can continue to examine how sentiment changes throughout the book. This is more relevant to the novels examples from the docs, but I'm including it here as an exercise. This example will use the <code>bing</code> lexicon. We need some type of interval - the example creates an index from 80 line chunks, but I'm going to update this to use the <code>chapter</code> value, which now represents the date of each tweet allowing to see changes in sentiment over time.</p>
<p>From the docs:</p>
<blockquote>
<p>... First, we find a sentiment score for each word using the Bing lexicon and inner_join().</p>
</blockquote>
<blockquote>
<p>Next, we count up how many positive and negative words there are in defined sections of each book. We define an index here to keep track of where we are in the narrative; this index (using integer division) counts up sections of 80 lines of text.</p>
</blockquote>
<blockquote>
<p>The %/% operator does integer division (x %/% y is equivalent to floor(x/y)) so the index keeps track of which 80-line section of text we are counting up negative and positive sentiment in.</p>
</blockquote>
<blockquote>
<p>Small sections of text may not have enough words in them to get a good estimate of sentiment while really large sections can wash out narrative structure. For these books, using 80 lines works well, but this can vary depending on individual texts, how long the lines were to start with, etc. We then use spread() so that we have negative and positive sentiment in separate columns, and lastly calculate a net sentiment (positive - negative).</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">philly_sentiment</span> <span class="o">&lt;-</span> <span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="c1">#count(book, index = linenumber %/% 80, sentiment) %&gt;% # 80-line tweet chunks</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">book</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">chapter</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">spread</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">=</span> <span class="n">positive</span> <span class="o">-</span> <span class="n">negative</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">ggplot</span><span class="p">(</span><span class="n">philly_sentiment</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">geom_col</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">))</span> <span class="o">+</span>
  <span class="c1">#facet_wrap(~book, ncol = 1, scales = &#34;free_x&#34;) # apply if we&#39;relooking across multiple books +</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Sentiment of &#39;Philadelphia&#39; Tweets&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_gradient2</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">mid</span><span class="o">=</span><span class="s">&#39;orange&#39;</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="s">&#39;navy&#39;</span><span class="p">)</span> <span class="o">+</span>
  <span class="c1">#scale_fill_viridis_c(option = &#34;viridis&#34;) +</span>
  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Sentiment&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/sentimentsplotone-1.png" width="672" /></p>
<h3 id="comparing-sentiments">Comparing sentiments</h3>
<p>Going to compare the different sentiment lexicons. Still writing the code as if there are multiple books (or search results) in the dataframe.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">philly_tweets</span> <span class="o">&lt;-</span> <span class="n">tidy_books</span> <span class="o">%&gt;%</span> 
  <span class="nf">filter</span><span class="p">(</span><span class="n">book</span> <span class="o">==</span> <span class="s">&#34;Philadelphia&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Using <code>dplyr::inner_join()</code>, estimate the different sentiment values for each lexicon.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1">## afinn</span>
<span class="n">afinn</span> <span class="o">&lt;-</span> <span class="n">philly_tweets</span> <span class="o">%&gt;%</span> 
  <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;afinn&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
  <span class="c1">#group_by(index = linenumber %/% 80) %&gt;% # Can use 80-line chunks</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">chapter</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># or other type of index value, like date</span>
  <span class="nf">summarise</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">value</span><span class="p">))</span> <span class="o">%&gt;%</span> 
  <span class="nf">mutate</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#34;AFINN&#34;</span><span class="p">)</span>

<span class="c1">## rbinding bing and nrc</span>
<span class="n">bing_and_nrc</span> <span class="o">&lt;-</span> <span class="nf">bind_rows</span><span class="p">(</span>
  <span class="n">philly_tweets</span> <span class="o">%&gt;%</span> 
    <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#34;Bing et al.&#34;</span><span class="p">),</span>
  <span class="n">philly_tweets</span> <span class="o">%&gt;%</span> 
    <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;nrc&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
                 <span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;positive&#34;</span><span class="p">,</span>
                                         <span class="s">&#34;negative&#34;</span><span class="p">))</span>
    <span class="p">)</span> <span class="o">%&gt;%</span>
    <span class="nf">mutate</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">&#34;NRC&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="c1">#count(method, index = linenumber %/% 80, sentiment) %&gt;% # Can use 80-line chunks</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">chapter</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># or other type of index value, like date</span>
  <span class="nf">spread</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">=</span> <span class="n">positive</span> <span class="o">-</span> <span class="n">negative</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Now combine and plot them together.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">bind_rows</span><span class="p">(</span><span class="n">afinn</span><span class="p">,</span> 
          <span class="n">bing_and_nrc</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">method</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_col</span><span class="p">(</span><span class="n">show.legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">method</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&#34;free_y&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Sentiment of &#39;Philadelphia&#39; Tweets - Lexicon Comparison&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Sentiment&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/sentimentplottwo-1.png" width="672" /></p>
<h3 id="some-routine-checks">Some routine checks</h3>
<p>When comparing results across different lexicons, consider word counts and the ratio of positive words to negative words.</p>
<p>TODO: Update include and eval settings here - ok to keep in md doc but no need to knit them</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;nrc&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;positive&#34;</span><span class="p">,</span> <span class="s">&#34;negative&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
  <span class="nf">count</span><span class="p">(</span><span class="n">sentiment</span><span class="p">)</span>
<span class="c1">## # A tibble: 2 x 2</span>
<span class="c1">##   sentiment     n</span>
<span class="c1">##   &lt;chr&gt;     &lt;int&gt;</span>
<span class="c1">## 1 negative   3324</span>
<span class="c1">## 2 positive   2312</span>

<span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="nf">count</span><span class="p">(</span><span class="n">sentiment</span><span class="p">)</span>
<span class="c1">## # A tibble: 2 x 2</span>
<span class="c1">##   sentiment     n</span>
<span class="c1">##   &lt;chr&gt;     &lt;int&gt;</span>
<span class="c1">## 1 negative   4781</span>
<span class="c1">## 2 positive   2005</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">bing_word_counts</span> <span class="o">&lt;-</span> <span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">ungroup</span><span class="p">()</span>

<span class="n">bing_word_counts</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">(</span><span class="m">25</span><span class="p">)</span>
<span class="c1">## # A tibble: 25 x 3</span>
<span class="c1">##    word       sentiment     n</span>
<span class="c1">##    &lt;chr&gt;      &lt;chr&gt;     &lt;int&gt;</span>
<span class="c1">##  1 corruption negative    120</span>
<span class="c1">##  2 like       positive     74</span>
<span class="c1">##  3 love       positive     58</span>
<span class="c1">##  4 great      positive     57</span>
<span class="c1">##  5 good       positive     56</span>
<span class="c1">##  6 best       positive     50</span>
<span class="c1">##  7 hurts      negative     42</span>
<span class="c1">##  8 well       positive     38</span>
<span class="c1">##  9 work       positive     29</span>
<span class="c1">## 10 free       positive     28</span>
<span class="c1">## # ... with 15 more rows</span>
</code></pre></td></tr></table>
</div>
</div><p>What are the top words driving sentiment score?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">bing_word_counts</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">sentiment</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">top_n</span><span class="p">(</span><span class="m">10</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">word</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">sentiment</span><span class="p">))</span> <span class="o">+</span>
  <span class="nf">geom_col</span><span class="p">(</span><span class="n">show.legend</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">scale_fill_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s">&#34;free_y&#34;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Contribution to sentiment&#34;</span><span class="p">,</span>
       <span class="n">y</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/sentplotfour-1.png" width="672" /></p>
<h3 id="wordclouds">Wordclouds</h3>
<p>I don't find wordclouds terrible useful, but they're not terrible for a background graphic or an attention grabber.</p>
<p>First, let's add some custom stop words (i.e. words to exclude from the analysis). If you want to know why, run the next chunk and see how URLs (and obviously our original search terms) throw off our term frequency matrix.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">custom_stop_words</span> <span class="o">&lt;-</span> <span class="nf">bind_rows</span><span class="p">(</span><span class="nf">tibble</span><span class="p">(</span><span class="n">word</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;philadelphia&#39;</span><span class="p">,</span> <span class="s">&#39;philly&#39;</span><span class="p">,</span> <span class="s">&#39;t.co&#39;</span><span class="p">,</span> <span class="s">&#39;https&#39;</span><span class="p">,</span> <span class="s">&#39;amp&#39;</span><span class="p">),</span>
                                      <span class="n">lexicon</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;custom&#34;</span><span class="p">)),</span>
                               <span class="n">stop_words</span><span class="p">)</span>

<span class="n">custom_stop_words</span> <span class="o">%&gt;%</span> <span class="nf">head</span><span class="p">()</span>
<span class="c1">## # A tibble: 6 x 2</span>
<span class="c1">##   word         lexicon</span>
<span class="c1">##   &lt;chr&gt;        &lt;chr&gt;  </span>
<span class="c1">## 1 philadelphia custom </span>
<span class="c1">## 2 philly       custom </span>
<span class="c1">## 3 t.co         custom </span>
<span class="c1">## 4 https        custom </span>
<span class="c1">## 5 amp          custom </span>
<span class="c1">## 6 a            SMART</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span>

<span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">anti_join</span><span class="p">(</span><span class="n">custom_stop_words</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">with</span><span class="p">(</span><span class="nf">wordcloud</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max.words</span> <span class="o">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="nf">brewer.pal</span><span class="p">(</span><span class="m">8</span><span class="p">,</span> <span class="s">&#34;Dark2&#34;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/wordcloudone-1.png" width="672" /></p>
<p>Going to compare the most popular positive and negative words using <code>comparison.cloud()</code>. Keep a look out for pronouns that get mistaken for positive or negative words (e.g. 'hurts' as in 'jalen hurts', though you might leave that in depending on how you feel about the Eagles qb situation).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="n">reshape2</span><span class="p">)</span>

<span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">inner_join</span><span class="p">(</span><span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">acast</span><span class="p">(</span><span class="n">word</span> <span class="o">~</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">value.var</span> <span class="o">=</span> <span class="s">&#34;n&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">comparison.cloud</span><span class="p">(</span><span class="n">colors</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;orange&#34;</span><span class="p">,</span> <span class="s">&#34;navy&#34;</span><span class="p">),</span>
                   <span class="n">max.words</span> <span class="o">=</span> <span class="m">100</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/post/2020-12-30-twitter-sentiment-philly/index_files/figure-html/wordcloudtwo-1.png" width="672" /></p>
<h3 id="what-about-sentences">What about sentences?</h3>
<p>Rather than assign sentiment to words, some algorithms attempt to derive sentiment from complete sentences, e.g. &quot;I am not having a good day&quot; should imply negative sentiment, not positive. Our tweets are already pretty succinct, so we can try to look at the entire tweek to make an assessment.</p>
<p>TODO: Fix how this is parsing sentences. See <a href="https://www.tidytextmining.com/sentiment.html#looking-at-units-beyond-just-words">docs</a></p>
<p>Using sentences, or some other type of index, we can assign a sentiment value - not by word - but by an entire chapter.</p>
<p>Which chapter (date) had the <em>highest proportion</em> of positive words?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="n">bingpositive</span> <span class="o">&lt;-</span> <span class="nf">get_sentiments</span><span class="p">(</span><span class="s">&#34;bing&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="nf">filter</span><span class="p">(</span><span class="n">sentiment</span> <span class="o">==</span> <span class="s">&#34;positive&#34;</span><span class="p">)</span>

<span class="n">wordcounts</span> <span class="o">&lt;-</span> <span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">book</span><span class="p">,</span> <span class="n">chapter</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">words</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span>

<span class="n">tidy_books</span> <span class="o">%&gt;%</span>
  <span class="nf">semi_join</span><span class="p">(</span><span class="n">bingpositive</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">group_by</span><span class="p">(</span><span class="n">book</span><span class="p">,</span> <span class="n">chapter</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">summarize</span><span class="p">(</span><span class="n">positivewords</span> <span class="o">=</span> <span class="nf">n</span><span class="p">())</span> <span class="o">%&gt;%</span>
  <span class="nf">left_join</span><span class="p">(</span><span class="n">wordcounts</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;book&#34;</span><span class="p">,</span> <span class="s">&#34;chapter&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">positive_ratio</span> <span class="o">=</span> <span class="n">positivewords</span><span class="o">/</span><span class="n">words</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">filter</span><span class="p">(</span><span class="n">chapter</span> <span class="o">!=</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">top_n</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="nf">ungroup</span><span class="p">()</span>
<span class="c1">## # A tibble: 1 x 5</span>
<span class="c1">##   book         chapter    positivewords words positive_ratio</span>
<span class="c1">##   &lt;chr&gt;        &lt;date&gt;             &lt;int&gt; &lt;int&gt;          &lt;dbl&gt;</span>
<span class="c1">## 1 Philadelphia 2020-12-21           196  5755         0.0341</span>
</code></pre></td></tr></table>
</div>
</div><!-- TO BE CONTINUED -->
<!-- ### Condition the data -->
<!-- Pre-process the data (source: bryangoodrich). -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- tweets <- iconv(tweets, to = "ASCII", sub = " ")  # Convert to basic ASCII text -->
<!-- tweets <- tolower(tweets)  # Make everything lower case -->
<!-- tweets <- gsub("rt", " ", tweets)  # Remove the "RT" (retweet) so duplicates are duplicates -->
<!-- tweets <- gsub("@\\w+", " ", tweets)  # Remove user names -->
<!-- tweets <- gsub("http.+ |http.+$", " ", tweets)  # Remove links -->
<!-- tweets <- gsub("[[:punct:]]", " ", tweets)  # Remove punctuation -->
<!-- tweets <- gsub("[ |\t]{2,}", " ", tweets)  # Remove tabs -->
<!-- tweets <- gsub("amp", " ", tweets)  # "&" is "&amp" in HTML, so after punctuation removed ... -->
<!-- tweets <- gsub("^ ", "", tweets)  # Leading blanks -->
<!-- tweets <- gsub(" $", "", tweets)  # Lagging blanks -->
<!-- tweets <- gsub(" +", " ", tweets) # General spaces (should just do all whitespaces no?) -->
<!-- tweets <- unique(tweets)  # Now get rid of duplicates! -->
<!-- ``` -->
<!-- Convert the `tweets` object to a corpus object to use with the `tm` package. -->
<!-- ```{r tm_corpus, eval = FALSE, include = FALSE} -->
<!-- corpus <- tm::Corpus(VectorSource(tweets))  -->
<!-- ``` -->
<!-- Remove English [stop words](https://rdrr.io/rforge/tm/man/stopwords.html). _Also see [Adding custom stopwords in R tm](https://stackoverflow.com/questions/18446408/adding-custom-stopwords-in-r-tm)_.   -->
<!-- ```{r stopwordstwo, eval = FALSE, include = FALSE} -->
<!-- corpus <- tm_map(corpus, removeWords, stopwords("en"))   -->
<!-- ``` -->
<!-- Remove the search terms from the corpus.  -->
<!-- _TODO: Make these variables and use paste() to place them in the search term earlier._ -->
<!-- ```{r rmsearchterms, eval = FALSE, include = FALSE} -->
<!-- #corpus <- tm_map(corpus, removeWords, c("energy", "electricity")) -->
<!-- corpus <- tm_map(corpus, removeWords, c('tesla', 'tsla')) -->
<!-- ``` -->
<!-- Remove numbers. -->
<!-- ```{r numbers, eval = FALSE, include = FALSE} -->
<!-- corpus <- tm_map(corpus, removeNumbers, mc.cores=1) -->
<!-- ``` -->
<!-- Stem the words  (e.g. likes, liked, likely, liking >> like). _For more on stemming and lemmatization, see [NLP Stanford](https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html)_. -->
<!-- ```{r stemming, eval = FALSE, include = FALSE} -->
<!-- corpus <- tm_map(corpus, stemDocument) -->
<!-- ``` -->
<!-- ### Visualization -->
<!-- Display the corpus as a word cloud. -->
<!-- ```{r wordcloud, eval = FALSE, include = FALSE} -->
<!-- pal <- brewer.pal(8, "Dark2") -->
<!-- wordcloud(corpus, min.freq=2, max.words = 150, random.order = TRUE, col = pal) -->
<!-- ``` -->
<!-- ### Topic Modeling -->
<!-- Get the lengths and make sure we only create a Document Term Matrix (DTM) for tweets with actual content. -->
<!-- ```{r dtm, eval = FALSE, include = FALSE} -->
<!-- doc_lengths <- corpus %>% DocumentTermMatrix() %>% as.matrix() %>% rowSums() -->
<!-- dtm <- corpus[doc_lengths > 0] %>% DocumentTermMatrix() -->
<!-- ``` -->
<!-- Test a Latent Dirichlet Allocation model; A LDA_VEM topic model with 2 topics. -->
<!-- ```{r lda, eval = FALSE, include = FALSE} -->
<!-- lda <- LDA(x = dtm, k = 2, method = 'VEM', control = list(seed = 1234)) -->
<!-- ``` -->
<!-- Explore it a bit with `tidytext` ([documentation](https://www.tidytextmining.com/topicmodeling.html)) -->
<!-- > tidytext package provides this method for extracting the per-topic-per-word probabilities, called  -->
<!-- β (“beta”), from the model ... For each combination, the model computes the probability of that term being generated from that topic -->
<!-- ```{r lda_topics, eval = FALSE, include = FALSE} -->
<!-- topics <- tidy(lda, matrix = "beta") -->
<!-- topics %>% arrange(-beta) %>% head(50) -->
<!-- ``` -->
<!-- Display top terms for each topic. -->
<!-- ```{r topterms, eval = FALSE, include = FALSE} -->
<!-- top_terms <- topics %>% -->
<!--   group_by(topic) %>% -->
<!--   top_n(10, beta) %>% -->
<!--   ungroup() %>% -->
<!--   arrange(topic, -beta) -->
<!-- top_terms %>% -->
<!--   mutate(term = reorder_within(term, beta, topic)) %>% -->
<!--   ggplot(aes(beta, term, fill = factor(topic))) + -->
<!--   geom_col(show.legend = FALSE) + -->
<!--   facet_wrap(~ topic, scales = "free") + -->
<!--   scale_y_reordered() + -->
<!--   labs( -->
<!--     title = 'Top Terms in Twitter Corpus' -->
<!--     , subtitle = 'The terms that are most common within each topic' -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r betaspread, eval = FALSE, include = FALSE} -->
<!-- beta_spread <- topics %>% -->
<!--   mutate(topic = paste0("topic", topic)) %>% -->
<!--   spread(topic, beta) %>% -->
<!--   filter(topic1 > .001 | topic2 > .001) %>% -->
<!--   mutate(log_ratio = log2(topic2 / topic1)) -->
<!-- beta_spread -->
<!-- ``` -->
<!-- Document topic probabilities. -->
<!-- > Each of these values is an estimated proportion of words from that document that are generated from that topic. For example, the model estimates that only about 25% of the words in document 1 were generated from topic 1. -->
<!-- ```{r doctopics, eval = FALSE, include = FALSE} -->
<!-- documents <- tidy(lda, matrix = "gamma") -->
<!-- documents %>% arrange(document) %>% head(50) -->
<!-- ``` -->
<!-- # Now for some topics -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- SEED = sample(1:1000000, 1)  # Pick a random seed for replication -->
<!-- k = 10  # Let's start with 10 topics -->
<!-- ``` -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- # This might take a minute! -->
<!-- models <- list( -->
<!--     CTM       = CTM(dtm, k = k, control = list(seed = SEED, var = list(tol = 10^-4), em = list(tol = 10^-3))), -->
<!--     VEM       = LDA(dtm, k = k, control = list(seed = SEED)), -->
<!--     VEM_Fixed = LDA(dtm, k = k, control = list(estimate.alpha = FALSE, seed = SEED)), -->
<!--     Gibbs     = LDA(dtm, k = k, method = "Gibbs", control = list(seed = SEED, burnin = 1000, -->
<!--                                                                  thin = 100,    iter = 1000)) -->
<!-- ) -->
<!-- ``` -->
<!-- # There you have it. Models now holds 4 topics. See the topicmodels API documentation for details -->
<!-- # Top 10 terms of each topic for each model -->
<!-- # Do you see any themes you can label to these "topics" (lists of words)? -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- lapply(models, terms, 10) -->
<!-- ``` -->
<!-- # matrix of tweet assignments to predominate topic on that tweet for each of the models, in case you wanted to categorize them -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- assignments <- sapply(models, topics) -->
<!-- ``` -->
<!-- ### Scrapyard -->
<!-- Configuring session for use with `twitteR` package   -->
<!-- ```{r configtwitteR, eval = FALSE, include = FALSE} -->
<!-- config <- config::get(file = 'config.yml') -->
<!-- my_config <- function() { -->
<!--     ckey = config$apikey -->
<!--     csec = config$apikeysecret -->
<!--     akey = config$accesstoken -->
<!--     asec = config$accesstokensecret -->
<!--     setup_twitter_oauth(ckey, csec, akey, asec)   -->
<!-- } -->
<!-- my_config() -->
<!-- ``` -->
<!-- **twitteR** -->
<!-- First, a few examples of searches from the help docs (excluding results): -->
<!-- ```{r examples, eval = FALSE, include = FALSE} -->
<!-- ## Search between two dates -->
<!-- searchTwitter('tesla', since = '2020-12-01', until = '2020-12-24') -->
<!-- ## Geocoded results -->
<!-- searchTwitter('patriots', geocode = '42.375, -71.1061111, 10mi') -->
<!-- ## Using resultType -->
<!-- searchTwitter('from:GrittyNHL', resultType = "popular", n = 50) -->
<!-- phl_tweets <- searchTwitter('philadelphia+philly', resultType = "recent", n = 15) -->
<!-- head(phl_tweets, 1) %>% str() -->
<!-- ``` -->
<!-- Going to write a function to format the results I care about into a tidy dataframe -->
<!-- ```{r, eval = FALSE, include = FALSE} -->
<!-- getTweets <- function(){ -->
<!--   searchTwitter('philadelphia+philly', resultType = "recent", n = 15) -->
<!-- } -->
<!-- ``` -->
<!-- Now, a convenience function for accessing the text part of a tweet returned by the twitteR API (source: bryangoodrich). -->
<!-- ```{r fun1, eval = FALSE, include = FALSE} -->
<!-- tweet_text <- function(x) x$getText() -->
<!-- ``` -->
<!-- Next, a search function that uses `tweet_text()` to extract the text from each tweet (source: bryangoodrich). -->
<!-- ```{r fun2, eval = FALSE, include = FALSE} -->
<!-- tweet_corpus <- function(search, n = 5000, ...) { -->
<!--     payload <- searchTwitter(search, n = n, ...) -->
<!--     sapply(payload, tweet_text) -->
<!-- } -->
<!-- ``` -->
<!-- Finally, run the search. This may take a few minutes. -->
<!-- ```{r search, eval = FALSE, include = FALSE} -->
<!-- #tweets <- tweet_corpus("energy+electricity", n = 100, lang = 'en') -->
<!-- tweets <- tweet_corpus('philadelphia+philly', n = 1000, lang = 'en') -->
<!-- ``` -->
<h3 id="post-content">Post content</h3>
<p>Typical location to start editing since the bibliography chunk is hidden. Make sure that you selected <code>R Markdown (.Rmd)</code> as the <em>format</em> option of the post when using the <code>New Post</code> <em><a href="https://CRAN.R-project.org/package=blogdown">blogdown</a></em> addin.</p>
<h3 id="r-image">R image</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-r" data-lang="r"><span class="c1">## This imaged will be saved in the /post/*_files/ directory</span>
<span class="c1">## Use echo = FALSE if you want to hide the code for making the plot</span>
<span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">,</span> <span class="m">10</span><span class="o">:</span><span class="m">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>If you prefer not to use the <code>fig.width</code> and <code>fig.height</code> options in every plot chunk, edit the YAML (the part at the top of the post) with:</p>
<pre><code>output:
  blogdown::html_page:
    toc: no
    fig_width: 5
    fig_height: 5
</code></pre><p>The spaces are important.</p>
<h3 id="custom-image">Custom image</h3>
<p>The easiest option is to use the <em><a href="https://CRAN.R-project.org/package=blogdown">blogdown</a></em> <em>Insert Image</em> RStudio addin to add an external image described in this <a href="http://lcolladotor.github.io/2018/03/07/blogdown-insert-image-addin">blog post</a>. You need to use version 0.5.7 or newer to have access to this plugin.</p>
<p>If you want to add images manually, check this <a href="http://lcolladotor.github.io/2018/02/17/r-markdown-blog-template/#.WqChJZPwa50">blog post</a> for more details on the image syntax.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>This blog post was made possible thanks to:</p>
<ul>
<li><em><a href="https://bioconductor.org/packages/3.12/BiocStyle">BiocStyle</a></em> <a id='cite-Oles_2020'></a>(<a href='https://github.com/Bioconductor/BiocStyle'>Oles, Morgan, and Huber, 2020</a>)</li>
<li><em><a href="https://CRAN.R-project.org/package=blogdown">blogdown</a></em> <a id='cite-Xie_2017'></a>(<a href='https://github.com/rstudio/blogdown'>Xie, Hill, and Thomas, 2017</a>)</li>
<li><em><a href="https://CRAN.R-project.org/package=devtools">devtools</a></em> <a id='cite-Wickham_2020'></a>(<a href='https://CRAN.R-project.org/package=devtools'>Wickham, Hester, and Chang, 2020</a>)</li>
<li><em><a href="https://CRAN.R-project.org/package=knitcitations">knitcitations</a></em> <a id='cite-Boettiger_2020'></a>(<a href='https://github.com/cboettig/knitcitations'>Boettiger, 2020</a>)</li>
</ul>
<h3 id="references">References</h3>
<p><a id='bib-Boettiger_2020'></a><a href="#cite-Boettiger_2020">[1]</a><cite>
C. Boettiger.
<em>knitcitations: Citations for 'Knitr' Markdown Files</em>.
R package version 1.0.11.
2020.
URL: <a href="https://github.com/cboettig/knitcitations">https://github.com/cboettig/knitcitations</a>.</cite></p>
<p><a id='bib-Oles_2020'></a><a href="#cite-Oles_2020">[2]</a><cite>
A. Oles, M. Morgan, and W. Huber.
<em>BiocStyle: Standard styles for vignettes and other Bioconductor documents</em>.
R package version 2.18.1.
2020.
URL: <a href="https://github.com/Bioconductor/BiocStyle">https://github.com/Bioconductor/BiocStyle</a>.</cite></p>
<p><a id='bib-Wickham_2020'></a><a href="#cite-Wickham_2020">[3]</a><cite>
H. Wickham, J. Hester, and W. Chang.
<em>devtools: Tools to Make Developing R Packages Easier</em>.
R package version 2.3.1.
2020.
URL: <a href="https://CRAN.R-project.org/package=devtools">https://CRAN.R-project.org/package=devtools</a>.</cite></p>
<p><a id='bib-Xie_2017'></a><a href="#cite-Xie_2017">[4]</a><cite>
Y. Xie, A. P. Hill, and A. Thomas.
<em>blogdown: Creating Websites with R Markdown</em>.
ISBN 978-0815363729.
Boca Raton, Florida: Chapman and Hall/CRC, 2017.
URL: <a href="https://github.com/rstudio/blogdown">https://github.com/rstudio/blogdown</a>.</cite></p>
<h3 id="reproducibility">Reproducibility</h3>
<pre><code>## - Session info -------------------------------------------------------------------------------------------------------
##  setting  value                       
##  version  R version 4.0.2 (2020-06-22)
##  os       Windows 10 x64              
##  system   x86_64, mingw32             
##  ui       RTerm                       
##  language (EN)                        
##  collate  English_United States.1252  
##  ctype    English_United States.1252  
##  tz       America/New_York            
##  date     2020-12-30                  
## 
## - Packages -----------------------------------------------------------------------------------------------------------
##  package       * version date       lib source                                 
##  assertthat      0.2.1   2019-03-21 [1] CRAN (R 4.0.2)                         
##  base64enc       0.1-3   2015-07-28 [1] CRAN (R 4.0.0)                         
##  BiocManager     1.30.10 2019-11-16 [1] CRAN (R 4.0.3)                         
##  BiocStyle     * 2.18.1  2020-11-24 [1] Bioconductor                           
##  blogdown        0.20    2020-06-23 [1] CRAN (R 4.0.2)                         
##  bookdown        0.21    2020-10-13 [1] CRAN (R 4.0.3)                         
##  callr           3.4.3   2020-03-28 [1] CRAN (R 4.0.2)                         
##  cli             2.2.0   2020-11-20 [1] CRAN (R 4.0.3)                         
##  colorspace      2.0-0   2020-11-11 [1] CRAN (R 4.0.3)                         
##  config        * 0.3.1   2020-12-17 [1] CRAN (R 4.0.3)                         
##  crayon          1.3.4   2017-09-16 [1] CRAN (R 4.0.2)                         
##  crosstalk       1.1.0.1 2020-03-13 [1] CRAN (R 4.0.2)                         
##  data.table      1.12.8  2019-12-09 [1] CRAN (R 4.0.0)                         
##  desc            1.2.0   2018-05-01 [1] CRAN (R 4.0.2)                         
##  devtools      * 2.3.1   2020-07-21 [1] CRAN (R 4.0.2)                         
##  digest          0.6.27  2020-10-24 [1] CRAN (R 4.0.3)                         
##  dplyr         * 1.0.2   2020-08-18 [1] CRAN (R 4.0.3)                         
##  DT              0.14    2020-06-24 [1] CRAN (R 4.0.2)                         
##  ellipsis        0.3.1   2020-05-15 [1] CRAN (R 4.0.2)                         
##  evaluate        0.14    2019-05-28 [1] CRAN (R 4.0.2)                         
##  fansi           0.4.1   2020-01-08 [1] CRAN (R 4.0.2)                         
##  farver          2.0.3   2020-01-16 [1] CRAN (R 4.0.2)                         
##  fs              1.5.0   2020-07-31 [1] CRAN (R 4.0.3)                         
##  generics        0.1.0   2020-10-31 [1] CRAN (R 4.0.3)                         
##  ggplot2       * 3.3.2   2020-06-19 [1] CRAN (R 4.0.2)                         
##  glue            1.4.2   2020-08-27 [1] CRAN (R 4.0.2)                         
##  gtable          0.3.0   2019-03-25 [1] CRAN (R 4.0.2)                         
##  hms             0.5.3   2020-01-08 [1] CRAN (R 4.0.2)                         
##  htmltools       0.5.0   2020-06-16 [1] CRAN (R 4.0.2)                         
##  htmlwidgets   * 1.5.2   2020-10-03 [1] CRAN (R 4.0.3)                         
##  httr            1.4.2   2020-07-20 [1] CRAN (R 4.0.3)                         
##  janeaustenr   * 0.1.5   2017-06-10 [1] CRAN (R 4.0.3)                         
##  jsonlite        1.7.2   2020-12-09 [1] CRAN (R 4.0.3)                         
##  knitcitations * 1.0.11  2020-12-30 [1] Github (cboettig/knitcitations@23750d5)
##  knitr           1.30    2020-09-22 [1] CRAN (R 4.0.3)                         
##  labeling        0.4.2   2020-10-20 [1] CRAN (R 4.0.3)                         
##  lattice         0.20-41 2020-04-02 [2] CRAN (R 4.0.2)                         
##  lazyeval        0.2.2   2019-03-15 [1] CRAN (R 4.0.2)                         
##  lifecycle       0.2.0   2020-03-06 [1] CRAN (R 4.0.2)                         
##  lubridate     * 1.7.9.2 2020-11-13 [1] CRAN (R 4.0.3)                         
##  magrittr        2.0.1   2020-11-17 [1] CRAN (R 4.0.3)                         
##  Matrix          1.2-18  2019-11-27 [2] CRAN (R 4.0.2)                         
##  memoise         1.1.0   2017-04-21 [1] CRAN (R 4.0.2)                         
##  modeltools      0.2-23  2020-03-05 [1] CRAN (R 4.0.3)                         
##  munsell         0.5.0   2018-06-12 [1] CRAN (R 4.0.2)                         
##  NLP           * 0.2-1   2020-10-14 [1] CRAN (R 4.0.3)                         
##  pillar          1.4.6   2020-07-10 [1] CRAN (R 4.0.3)                         
##  pkgbuild        1.0.8   2020-05-07 [1] CRAN (R 4.0.2)                         
##  pkgconfig       2.0.3   2019-09-22 [1] CRAN (R 4.0.2)                         
##  pkgload         1.1.0   2020-05-29 [1] CRAN (R 4.0.2)                         
##  plotly        * 4.9.2.1 2020-04-04 [1] CRAN (R 4.0.2)                         
##  plyr            1.8.6   2020-03-03 [1] CRAN (R 4.0.2)                         
##  prettyunits     1.1.1   2020-01-24 [1] CRAN (R 4.0.2)                         
##  processx        3.4.4   2020-09-03 [1] CRAN (R 4.0.3)                         
##  ps              1.4.0   2020-10-07 [1] CRAN (R 4.0.3)                         
##  purrr           0.3.4   2020-04-17 [1] CRAN (R 4.0.2)                         
##  R6              2.5.0   2020-10-28 [1] CRAN (R 4.0.3)                         
##  rappdirs        0.3.1   2016-03-28 [1] CRAN (R 4.0.2)                         
##  RColorBrewer  * 1.1-2   2014-12-07 [1] CRAN (R 4.0.0)                         
##  Rcpp            1.0.5   2020-07-06 [1] CRAN (R 4.0.2)                         
##  readr         * 1.4.0   2020-10-05 [1] CRAN (R 4.0.3)                         
##  RefManageR      1.3.0   2020-11-13 [1] CRAN (R 4.0.3)                         
##  remotes         2.2.0   2020-07-21 [1] CRAN (R 4.0.3)                         
##  repr            1.1.0   2020-01-28 [1] CRAN (R 4.0.3)                         
##  reshape2      * 1.4.4   2020-04-09 [1] CRAN (R 4.0.2)                         
##  rlang           0.4.9   2020-11-26 [1] CRAN (R 4.0.3)                         
##  rmarkdown     * 2.5     2020-10-21 [1] CRAN (R 4.0.3)                         
##  rprojroot       2.0.2   2020-11-15 [1] CRAN (R 4.0.2)                         
##  rtweet        * 0.7.0   2020-01-08 [1] CRAN (R 4.0.3)                         
##  scales          1.1.1   2020-05-11 [1] CRAN (R 4.0.2)                         
##  sessioninfo     1.1.1   2018-11-05 [1] CRAN (R 4.0.2)                         
##  skimr         * 2.1.2   2020-07-06 [1] CRAN (R 4.0.3)                         
##  slam            0.1-48  2020-12-03 [1] CRAN (R 4.0.3)                         
##  SnowballC     * 0.7.0   2020-04-01 [1] CRAN (R 4.0.3)                         
##  stringi         1.5.3   2020-09-09 [1] CRAN (R 4.0.3)                         
##  stringr       * 1.4.0   2019-02-10 [1] CRAN (R 4.0.2)                         
##  testthat        2.3.2   2020-03-02 [1] CRAN (R 4.0.2)                         
##  textdata        0.4.1   2020-05-04 [1] CRAN (R 4.0.3)                         
##  tibble          3.0.4   2020-10-12 [1] CRAN (R 4.0.3)                         
##  tidyr         * 1.1.2   2020-08-27 [1] CRAN (R 4.0.3)                         
##  tidyselect      1.1.0   2020-05-11 [1] CRAN (R 4.0.2)                         
##  tidytext      * 0.2.6   2020-09-20 [1] CRAN (R 4.0.3)                         
##  tm            * 0.7-8   2020-11-18 [1] CRAN (R 4.0.3)                         
##  tokenizers      0.2.1   2018-03-29 [1] CRAN (R 4.0.3)                         
##  topicmodels   * 0.2-11  2020-04-19 [1] CRAN (R 4.0.3)                         
##  usethis       * 2.0.0   2020-12-10 [1] CRAN (R 4.0.3)                         
##  utf8            1.1.4   2018-05-24 [1] CRAN (R 4.0.2)                         
##  vctrs           0.3.4   2020-08-29 [1] CRAN (R 4.0.3)                         
##  viridisLite     0.3.0   2018-02-01 [1] CRAN (R 4.0.2)                         
##  widgetframe   * 0.3.1   2017-12-20 [1] CRAN (R 4.0.3)                         
##  withr           2.3.0   2020-09-22 [1] CRAN (R 4.0.3)                         
##  wordcloud     * 2.6     2018-08-24 [1] CRAN (R 4.0.3)                         
##  xfun            0.19    2020-10-30 [1] CRAN (R 4.0.3)                         
##  xml2            1.3.2   2020-04-23 [1] CRAN (R 4.0.2)                         
##  yaml            2.2.1   2020-02-01 [1] CRAN (R 4.0.0)                         
## 
## [1] C:/Users/rober/Documents/R/win-library/4.0
## [2] C:/Program Files/R/R-4.0.2/library
</code></pre>
    <div class="pager">
  
  <div class="pager_item prev">
    
    <a href="/2020/12/30/custom-color-palette/" class="pager_link button" title="Custom Color Palette">
      <span class="pager_label">Custom Color Palette</span>
    </a>
  </div>
  

  
</div>
<svg width="0" height="0" class="hidden">
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492.004 492.004" id="next">
    <path d="M484.14 226.886L306.46 49.202c-5.072-5.072-11.832-7.856-19.04-7.856-7.216 0-13.972 2.788-19.044 7.856l-16.132 16.136c-5.068 5.064-7.86 11.828-7.86 19.04 0 7.208 2.792 14.2 7.86 19.264L355.9 207.526H26.58C11.732 207.526 0 219.15 0 234.002v22.812c0 14.852 11.732 27.648 26.58 27.648h330.496L252.248 388.926c-5.068 5.072-7.86 11.652-7.86 18.864 0 7.204 2.792 13.88 7.86 18.948l16.132 16.084c5.072 5.072 11.828 7.836 19.044 7.836 7.208 0 13.968-2.8 19.04-7.872l177.68-177.68c5.084-5.088 7.88-11.88 7.86-19.1.016-7.244-2.776-14.04-7.864-19.12z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.999 511.999" id="search">
    <path d="M508.874 478.708L360.142 329.976c28.21-34.827 45.191-79.103 45.191-127.309C405.333 90.917 314.416 0 202.666 0S0 90.917 0 202.667s90.917 202.667 202.667 202.667c48.206 0 92.482-16.982 127.309-45.191l148.732 148.732c4.167 4.165 10.919 4.165 15.086 0l15.081-15.082c4.165-4.166 4.165-10.92-.001-15.085zM202.667 362.667c-88.229 0-160-71.771-160-160s71.771-160 160-160 160 71.771 160 160-71.771 160-160 160z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 241 179" id="harmburger">
    <path d="M1 10C1 4.477 5.477 0 11 0h220c5.523 0 10 4.477 10 10s-4.477 10-10 10H11C5.477 20 1 15.523 1 10zm0 80c0-5.523 4.477-10 10-10h220c5.523 0 10 4.477 10 10s-4.477 10-10 10H11c-5.523 0-10-4.477-10-10zm9 69c-5.523 0-10 4.477-10 10s4.477 10 10 10h220c5.523 0 10-4.477 10-10s-4.477-10-10-10H10z"></path>
  </symbol>
</svg>
  </main>
</div>

  </div>
<footer class="pt-2 pb-2">
  <div class="wrap">
    <p>&copy; 2020 rjfranssen</p>
  </div>
</footer>


<svg width="0" height="0" class="hidden">
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492.004 492.004" id="next">
    <path d="M484.14 226.886L306.46 49.202c-5.072-5.072-11.832-7.856-19.04-7.856-7.216 0-13.972 2.788-19.044 7.856l-16.132 16.136c-5.068 5.064-7.86 11.828-7.86 19.04 0 7.208 2.792 14.2 7.86 19.264L355.9 207.526H26.58C11.732 207.526 0 219.15 0 234.002v22.812c0 14.852 11.732 27.648 26.58 27.648h330.496L252.248 388.926c-5.068 5.072-7.86 11.652-7.86 18.864 0 7.204 2.792 13.88 7.86 18.948l16.132 16.084c5.072 5.072 11.828 7.836 19.044 7.836 7.208 0 13.968-2.8 19.04-7.872l177.68-177.68c5.084-5.088 7.88-11.88 7.86-19.1.016-7.244-2.776-14.04-7.864-19.12z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 511.999 511.999" id="search">
    <path d="M508.874 478.708L360.142 329.976c28.21-34.827 45.191-79.103 45.191-127.309C405.333 90.917 314.416 0 202.666 0S0 90.917 0 202.667s90.917 202.667 202.667 202.667c48.206 0 92.482-16.982 127.309-45.191l148.732 148.732c4.167 4.165 10.919 4.165 15.086 0l15.081-15.082c4.165-4.166 4.165-10.92-.001-15.085zM202.667 362.667c-88.229 0-160-71.771-160-160s71.771-160 160-160 160 71.771 160 160-71.771 160-160 160z"></path>
  </symbol>
  <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 241 179" id="harmburger">
    <path d="M1 10C1 4.477 5.477 0 11 0h220c5.523 0 10 4.477 10 10s-4.477 10-10 10H11C5.477 20 1 15.523 1 10zm0 80c0-5.523 4.477-10 10-10h220c5.523 0 10 4.477 10 10s-4.477 10-10 10H11c-5.523 0-10-4.477-10-10zm9 69c-5.523 0-10 4.477-10 10s4.477 10 10 10h220c5.523 0 10-4.477 10-10s-4.477-10-10-10H10z"></path>
  </symbol>
</svg>
<script src="/js/bundle.min.02545d1b796e3dc21ed6179e9cc71c1d0b6d8c842047dcfe72785cc4fc15f2a09cefa8fc9a8ed491e8e9fb30fcec32ea64c411ddf411e3e8c681f189dffc64fa.js"></script>
<script src="/js/search.min.ec6828efc4fa6448b8a97ee543727eac2757b9be75aa4c4cee0095df2ba3c38054510453b913f9b4307b69465a598427a716b308afa3cb51e3280bface0b1a32.js" async defer></script>

</body>
</html>
